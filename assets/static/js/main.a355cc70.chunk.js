(this["webpackJsonpbug-tracker"]=this["webpackJsonpbug-tracker"]||[]).push([[0],{377:function(e,t,n){},419:function(e,t){},639:function(e,t,n){},640:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),s=n(48),c=n.n(s),o=(n(377),n(14)),i=n(15),l=n(21),u=n(20),d=n(7),p=n.n(d),h=n(8),b=n(31),j=n(50),g=n(648),f=n(650),m=n(649),x=n(367),O=n(656),v=n(661),y=n(53),w=n(12),C=n.n(w),k=n(45),S=n.n(k),I=function(e){return e.response?"string"===typeof e.response.data?e.response.data.split("\n")[0]:403===e.response.status?"FORBIDDEN":500===e.response.status?"Server Error":"unknown":e.request?"Request Timeout":e.message},N=function(e){console.error("Error: "+I(e))},M="https://bugg.imranbey.com",D=function(){return{"x-auth-token":window.localStorage.getItem("token")}},A="https://bugg.imranbey.com",U={baseUrl:M,getDefaultHeader:D,staticServerUrl:A};!function(){if(!document.io){var e=n(395),t=n(422)(e);document.io=t,t.sails.url=M,t.sails.rejectUnauthorized=!1,t.sails.reconnection=!0,t.socket.on("connect",(function(){t.socket.request({method:"POST",url:"/message/subscribe",headers:D()},(function(e,t){console.log(e),console.log(t),console.log("Possibly Joined room")}))}))}}();var E=function(e,t){console.log("listening on "+e),document.io.socket.on(e,t)},P=function(e,t){console.log("remove listeners on "+e),document.io.socket.off(e,t)},B=function(){document.io.socket.request({method:"POST",url:"/message/subscribe",headers:D()},(function(e,t){console.log(e),console.log(t),console.log("Possibly Joined room")}))},T=function(e){document.io.socket.request({method:"POST",url:"/message/unsubscribe",headers:{"x-auth-token":e}},(function(e,t){console.log(e),console.log(t),console.log("Possibly Joined room")}))},R=n(1),L=f.a.Title,F=function(){var e=Object(a.useState)(""),t=Object(b.a)(e,2),n=t[0],r=t[1],s=Object(a.useState)(""),c=Object(b.a)(s,2),o=c[0],i=c[1],l=Object(a.useState)(""),u=Object(b.a)(l,2),d=u[0],w=u[1],S=Object(k.useMediaQuery)({maxWidth:800}),N=Object(a.useState)("login"),D=Object(b.a)(N,2),A=D[0],U=D[1],E=Object(a.useState)(!1),P=Object(b.a)(E,2),T=P[0],F=P[1],z=Object(a.useState)(!1),_=Object(b.a)(z,2),W=_[0],V=_[1],q=m.a.useForm(),H=Object(b.a)(q,1)[0],Y=function(){var e=Object(h.a)(p.a.mark((function e(){var t,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(F(!0),console.log(d),e.prev=2,"login"!==A){e.next=10;break}return console.log(d),e.next=7,C.a.post(M+"/user/login",{email:o,password:d});case 7:t=e.sent,e.next=13;break;case 10:return e.next=12,C.a.post(M+"/user/signup",{name:n,email:o,password:d});case 12:t=e.sent;case 13:e.next=20;break;case 15:e.prev=15,e.t0=e.catch(2),a=I(e.t0),console.error("Error: "+a),x.a.error({message:"Could not ".concat(A,": ")+I(e.t0)});case 20:F(!1),t&&(x.a.success({message:t.data.message}),window.localStorage.setItem("token",t.data.token),B(),V(!0));case 22:case"end":return e.stop()}}),e,null,[[2,15]])})));return function(){return e.apply(this,arguments)}}(),Q=function(){U("login"===A?"signup":"login")},X=function(){var e=Object(h.a)(p.a.mark((function e(){var t,n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return F(!0),e.prev=1,e.next=4,C.a.post("/user/demo");case 4:t=e.sent,n=t.data.token,x.a.success({message:"Logged in as demo"}),window.localStorage.setItem("token",n),B(),F(!1),V(!0),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),F(!1),x.a.error({message:I(e.t0)});case 17:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(){return e.apply(this,arguments)}}();return Object(R.jsxs)("div",{className:"App",style:{margin:0,padding:0,display:"flex",flexDirection:S?"column":"row",paddingLeft:S?10:64,paddingRight:S?10:64,paddingTop:64,minHeight:"100vh",backgroundImage:"url('https://images.unsplash.com/photo-1617653695386-1d78957d33f8?ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&ixlib=rb-1.2.1&auto=format&fit=crop&w=2000&q=80')",backgroundSize:"cover",backgroundPosition:"center"},children:[W?Object(R.jsx)(j.a,{to:"/dashboard"}):null,Object(R.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:S?"center":"flex-start",flex:S?"unset":1},children:[Object(R.jsx)("h1",{style:{color:"white",fontSize:48,margin:0},children:"Bugg"}),Object(R.jsx)("p",{style:{color:"white",marginBottom:30,opacity:.9},children:"A simple bug tracker"})]}),Object(R.jsx)("div",{style:{flex:S?"unset":1,display:S?"flex":"unset",flexDirection:S?"row":"unset",justifyContent:S?"center":"unset"},children:Object(R.jsx)(g.a,{style:{maxWidth:S?450:"unset",marginBottom:30,borderRadius:5,flex:1},children:Object(R.jsxs)(m.a,{name:"basic",labelAlign:"left",labelCol:{span:8},wrapperCol:{span:16},initialValues:{remember:!0},form:H,onFinish:Y,onFinishFailed:function(){return!1},children:[Object(R.jsx)(f.a,{children:"login"===A?Object(R.jsx)(L,{children:"Login"}):Object(R.jsx)(L,{children:"Signup"})}),Object(R.jsx)("h4",{style:{marginBottom:30},children:"login"===A?Object(R.jsxs)(R.Fragment,{children:["Don't have an account? ",Object(R.jsx)("a",{href:"#",onClick:Q,children:"Sign up"})]}):Object(R.jsxs)(R.Fragment,{children:["Already have an account? ",Object(R.jsx)("a",{href:"#",onClick:Q,children:"Login"})]})}),"signup"===A?Object(R.jsx)(R.Fragment,{children:Object(R.jsx)(m.a.Item,{label:"Name",name:"name",style:{},rules:[{required:!0,message:"Please input your name!"}],children:Object(R.jsx)(O.a,{type:"text",onChange:function(e){return r(e.target.value)}})})}):null,Object(R.jsx)(m.a.Item,{name:"email",label:"Email",rules:[{required:!0,type:"email"}],children:Object(R.jsx)(O.a,{onChange:function(e){return i(e.target.value)}})}),Object(R.jsx)(m.a.Item,{label:"Password",name:"password",rules:[{required:!0,message:"Please input your password!"}],children:Object(R.jsx)(O.a.Password,{onChange:function(e){return w(e.target.value)}})}),"signup"===A?Object(R.jsx)(m.a.Item,{label:"Confirm Passord",name:"confirm-password",rules:[{required:!0,message:"Please input your password!"}],children:Object(R.jsx)(O.a.Password,{})}):null,Object(R.jsx)(m.a.Item,{wrapperCol:{offset:0,span:16},children:Object(R.jsxs)(v.b,{children:[Object(R.jsx)(y.a,{loading:T,type:"primary",htmlType:"submit",children:"SUBMIT"}),Object(R.jsx)(y.a,{onClick:X,children:"Use Demo Account Instead"})]})})]})})})]})},z=n(55),_=n(363),W=n(144),V=n(87),q=n(651),H=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).renderChart=function(){return new Promise((function(e){var t=document.getElementById("pieChart").getContext("2d"),n=new _.a(t,{type:"pie",data:{labels:["Open","Closed"],datasets:[{label:"My First Dataset",data:[a.state.totalBugsOpen,a.state.totalBugsClosed],backgroundColor:["#f50","#389e0d"],hoverOffset:4}]}});a.setState({pieChart:n},e)}))},a.updateChart=Object(h.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(t=a.state.pieChart).data.datasets[0].data=[a.state.totalBugsOpen,a.state.totalBugsClosed],t.update();case 3:case"end":return e.stop()}}),e)}))),a.fetchStats=Object(h.a)(p.a.mark((function e(){var t,n,r,s,c,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C.a.get("/project/stats/"+a.props.project.id,{headers:D()});case 3:t=e.sent,n=t.data,r=n.totalBugs,s=n.totalBugsClosed,c=n.totalBugsOpen,o=n.totalMembers,a.setState({totalBugs:r,totalBugsClosed:s,totalBugsOpen:c,totalMembers:o},a.updateChart),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),N(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])}))),a.state={isAuthed:!1,totalBugs:0,totalBugsClosed:0,totalBugsOpen:0,totalMembers:0,pieChart:null},a}return Object(i.a)(n,[{key:"componentDidMount",value:function(){var e=Object(h.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.renderChart();case 2:this.fetchStats();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(e){e.project.id!==this.props.project.id&&this.fetchStats()}},{key:"render",value:function(){var e=this;return Object(R.jsx)(S.a,{maxWidth:800,children:function(t){return Object(R.jsx)(r.a.Fragment,{children:Object(R.jsxs)("div",{style:{display:t?"flex":"inline-flex",flexDirection:t?"column":"unset",marginRight:t?10:64,gap:10},children:[Object(R.jsx)(g.a,{title:"Statistics",children:Object(R.jsxs)(W.a,{gutter:16,children:[Object(R.jsx)(V.a,{span:12,children:Object(R.jsx)(q.a,{title:"Members",value:e.state.totalMembers})}),Object(R.jsx)(V.a,{span:12,children:Object(R.jsx)(q.a,{title:"Bugs Submited",value:e.state.totalBugs})}),Object(R.jsx)(V.a,{span:12,children:Object(R.jsx)(q.a,{title:"Bugs Open",value:e.state.totalBugsOpen})}),Object(R.jsx)(V.a,{span:12,children:Object(R.jsx)(q.a,{title:"Bugs Closed",value:e.state.totalBugsClosed})})]})}),Object(R.jsx)(g.a,{title:"Progress",style:{},children:Object(R.jsx)(v.b,{style:{width:"100%"},direction:"vertical",align:"center",children:Object(R.jsx)("canvas",{id:"pieChart"})})})]})})}})}}]),n}(r.a.Component),Y=n(35),Q=n(30),X=n(64),G=n(103),J=(n(243),n(652)),K=n(109),Z=n(647),$=n(664),ee=n(104),te=n.n(ee),ne=Z.a.Dragger,ae=K.a.Option,re=Object(j.h)((function(e){var t=Object(a.useState)(X.EditorState.createEmpty()),n=Object(b.a)(t,2),r=n[0],s=n[1],c=Object(a.useState)(""),o=Object(b.a)(c,2),i=o[0],l=o[1],u=Object(a.useState)([]),d=Object(b.a)(u,2),j=d[0],g=d[1],f=Object(a.useState)([]),w=Object(b.a)(f,2),k=w[0],S=w[1],N=Object(a.useState)(0),M=Object(b.a)(N,2),A=M[0],U=M[1],E=Object(a.useState)([]),P=Object(b.a)(E,1)[0],B=Object(a.useState)(""),T=Object(b.a)(B,2),L=T[0],F=T[1],z=Object(a.useState)(""),_=Object(b.a)(z,2),W=_[0],V=_[1],q=Object(a.useState)(""),H=Object(b.a)(q,2),Y=H[0],Z=H[1],ee=Object(a.useState)(new FormData),re=Object(b.a)(ee,1)[0],se=Object(a.useState)([]),ce=Object(b.a)(se,1)[0],oe=function(){var e=Object(h.a)(p.a.mark((function e(t,n){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ce.push(t),e.abrupt("return",!1);case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();function ie(){return(ie=Object(h.a)(p.a.mark((function t(n){var a,s,c,o,l;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=te()(Object(X.convertToRaw)(r.getCurrentContent())),t.prev=1,s={description:a,title:i,tags:j.join(","),dueDate:0===A?void 0:A.toDate().getTime(),assignTo:P.join(","),severity:L,reproducibility:W,catagory:Y,assignees:k.join(","),projectId:e.match.params.projectId},t.next=5,C.a.post("/bug/create",s,{headers:D()});case 5:if(c=t.sent,o=c.data,console.log(o),0===ce.length){t.next=13;break}for(l=0;l<ce.length;l++)re.append("files",ce[l]);return console.log(re.getAll("files")),t.next=13,C.a.post("/file/",re,{headers:Object(Q.a)(Object(Q.a)({},D()),{},{"Content-Type":"multipart/form-data"}),params:{bugId:o.id}});case 13:e.toggleFunc(),e._handleListUpdate(),x.a.success({message:"Bug was submitted!"}),t.next=22;break;case 18:t.prev=18,t.t0=t.catch(1),console.error(I(t.t0)),x.a.error({message:I(t.t0)});case 22:case"end":return t.stop()}}),t,null,[[1,18]])})))).apply(this,arguments)}var le=Object(a.useState)([]),ue=Object(b.a)(le,2),de=ue[0],pe=ue[1],he=Object(a.useState)(),be=Object(b.a)(he,2),je=be[0],ge=be[1];return Object(a.useEffect)((function(){(function(){var t=Object(h.a)(p.a.mark((function t(){var n,a,r,s;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,C.a.get("/user/search",{params:{query:je,projectId:e.match.params.projectId,isIn:!0},headers:D()});case 3:n=t.sent,t.next=10;break;case 6:return t.prev=6,t.t0=t.catch(0),console.error(I(t.t0)),t.abrupt("return");case 10:for(a=[],r=n.data.results,s=0;s<r.length;s++)a.push({key:r[s].id,name:r[s].name,email:r[s].email,id:r[s].id});pe(a);case 14:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(){return t.apply(this,arguments)}})()()}),[je]),Object(R.jsx)("div",{style:{width:"100%"},children:Object(R.jsxs)(m.a,{name:"basic",labelCol:{span:8},wrapperCol:{span:24},initialValues:{remember:!1},layout:"vertical",onFinish:function(e){return ie.apply(this,arguments)},onFinishFailed:function(e){console.log("Failed:",e),x.a.error({message:"Please input title"})},children:[Object(R.jsx)(m.a.Item,{label:"Title",name:"title",rules:[{required:!0,remember:!1}],children:Object(R.jsx)(O.a,{type:"text",autoComplete:"off",onChange:function(e){return l(e.target.value)}})}),Object(R.jsx)("style",{children:"\n                    .demo-editor {\n                        padding: 0px 10px 0px 10px;\n                        border-color: rgba(0,0,0,.1);\n                        border-style: solid;\n                        border-width: 1px;\n                        min-height: 150px\n                    }\n                    "}),Object(R.jsx)(m.a.Item,{label:"Description",name:"description",rules:[{required:!1}],children:Object(R.jsx)(G.Editor,{editorState:r,wrapperClassName:"demo-wrapper",editorClassName:"demo-editor",onEditorStateChange:s})}),Object(R.jsxs)(m.a.Item,{label:"Tags",name:"tags",rules:[{required:!1}],children:[Object(R.jsx)(K.a,{mode:"tags",style:{width:"100%"},placeholder:"Tags Mode",onChange:function(e){return g(e)}}),","]}),Object(R.jsxs)(ne,{style:{marginBottom:20},multiple:!0,beforeUpload:oe,onRemove:function(e){for(var t=0;t<ce.length;t++)if(ce[t].uid===e.uid){ce.splice(t,1);break}},children:[Object(R.jsx)("p",{className:"ant-upload-drag-icon",children:Object(R.jsx)($.a,{})}),Object(R.jsx)("p",{className:"ant-upload-text",children:"Click or drag file to this area to upload"}),Object(R.jsx)("p",{className:"ant-upload-hint",children:"Support for a single or bulk upload. Strictly prohibit from uploading company data or other band files"})]}),Object(R.jsx)(m.a.Item,{label:"Due Date",name:"due-date",style:{marginTop:20},rules:[{required:!1}],children:Object(R.jsx)(J.a,{style:{width:"100%"},onChange:U})}),Object(R.jsx)(m.a.Item,{label:"Assign To...",name:"assignees",rules:[{required:!1}],children:Object(R.jsx)(K.a,{showSearch:!0,mode:"multiple",placeholder:"search...",filterOption:!1,onSearch:ge,onChange:function(e,t){S(e)},children:de.map((function(e){return Object(R.jsx)(ae,{children:"".concat(e.name," (").concat(e.email,")")},e.id)}))})}),Object(R.jsx)(m.a.Item,{label:"Severity",name:"severity",rules:[{required:!1}],children:Object(R.jsxs)(K.a,{showSearch:!0,placeholder:"Search to Select",optionFilterProp:"children",filterOption:function(e,t){return t.children.toLowerCase().indexOf(e.toLowerCase())>=0},filterSort:function(e,t){return e.children.toLowerCase().localeCompare(t.children.toLowerCase())},onChange:F,children:[Object(R.jsx)(ae,{value:"None",children:"None"}),Object(R.jsx)(ae,{value:"Critical",children:"Critical"}),Object(R.jsx)(ae,{value:"Major",children:"Major"}),Object(R.jsx)(ae,{value:"Minor",children:"Minor"})]})}),Object(R.jsx)(m.a.Item,{label:"Reproducibility",name:"reproducibility",rules:[{required:!1}],children:Object(R.jsxs)(K.a,{onChange:V,showSearch:!0,placeholder:"Search to Select",optionFilterProp:"children",filterOption:function(e,t){return t.children.toLowerCase().indexOf(e.toLowerCase())>=0},filterSort:function(e,t){return e.children.toLowerCase().localeCompare(t.children.toLowerCase())},children:[Object(R.jsx)(ae,{value:"Always",children:"Always"}),Object(R.jsx)(ae,{value:"Sometimes",children:"Sometimes"}),Object(R.jsx)(ae,{value:"Rarely",children:"Rarely"}),Object(R.jsx)(ae,{value:"Unable",children:"Unable"}),Object(R.jsx)(ae,{value:"Never tried",children:"Never tried"}),Object(R.jsx)(ae,{value:"N/A",children:"N/A"})]})}),Object(R.jsx)(m.a.Item,{label:"Catagory",name:"catagory",rules:[{required:!1}],children:Object(R.jsxs)(K.a,{showSearch:!0,onChange:Z,placeholder:"Search to Select",optionFilterProp:"children",filterOption:function(e,t){return t.children.toLowerCase().indexOf(e.toLowerCase())>=0},filterSort:function(e,t){return e.children.toLowerCase().localeCompare(t.children.toLowerCase())},children:[Object(R.jsx)(ae,{value:"Security",children:"Security"}),Object(R.jsx)(ae,{value:"Data Loss",children:"Data Loss"}),Object(R.jsx)(ae,{value:"Performance",children:"Performance"}),Object(R.jsx)(ae,{value:"Crash/Hang",children:"Crash/Hang"}),Object(R.jsx)(ae,{value:"Other Bug",children:"Other Bug"}),Object(R.jsx)(ae,{value:"UI",children:"UI"}),Object(R.jsx)(ae,{value:"New Feature",children:"New Feature"}),Object(R.jsx)(ae,{value:"Enhancement",children:"Enhancement"})]})}),Object(R.jsxs)(v.b,{style:{width:"100%",display:"inline-flex",justifyContent:"flex-end"},children:[Object(R.jsx)(y.a,{onClick:e.toggleFunc,children:"Cancel"}),Object(R.jsx)(y.a,{htmlType:"submit",type:"primary",children:"Submit"})]})]})})})),se=n(364),ce=n(655),oe=n(653),ie=n(660),le=n(663),ue=n(658),de=n(213),pe=n(665),he=n(666),be=n(370),je=n(44),ge=n(662),fe=n(644),me=n(645),xe=n(657),Oe=n(41),ve=n.n(Oe),ye=f.a.Title,we=function(e){var t=e.comments;return Object(R.jsx)(ge.b,{dataSource:t,header:"".concat(t.length," ").concat(t.length>1?"replies":"reply"),itemLayout:"horizontal",renderItem:function(e){return Object(R.jsx)(fe.a,Object(Q.a)({},e))}})},Ce=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={comments:[],submitting:!1,value:"",editorState:X.EditorState.createEmpty()},e.TOKEN=window.localStorage.getItem("token"),e._handleUpdateComments=Object(h.a)(p.a.mark((function t(){var n,a,r;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,C.a.get("/comment",{headers:D(),params:{bugId:e.props.bug.id}});case 3:n=t.sent,a=n.data,r=a.comments.map((function(e){return{author:e.owner.name,key:e.id,avatar:"https://zos.alipayobjects.com/rmsportal/ODTLcjxAfvqbxHnVXCYX.png",content:Object(R.jsx)("div",{style:{width:700,minHeight:50,overflowX:"auto"},dangerouslySetInnerHTML:{__html:e.body}}),datetime:ve()(new Date(e.createdAt)).fromNow()}})),e.setState({comments:[].concat(Object(je.a)(e.state.comments),Object(je.a)(r)).reverse()}),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),console.error(I(t.t0));case 12:case"end":return t.stop()}}),t,null,[[0,9]])}))),e.handleSubmit=Object(h.a)(p.a.mark((function t(){return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.state.value){t.next=2;break}return t.abrupt("return");case 2:return e.setState({submitting:!0}),t.prev=3,t.next=6,C.a.post("/comment/",{bugId:e.props.bug.id,body:e.state.value},{headers:D()});case 6:t.next=13;break;case 8:return t.prev=8,t.t0=t.catch(3),t.t0.response?console.log(t.t0.response):console.log(t.t0),se.b.error("Could not send message: "+I(t.t0)),t.abrupt("return",e.setState({submitting:!1}));case 13:e.setState({submitting:!1,value:"",comments:[{author:"Han Solo",avatar:"https://zos.alipayobjects.com/rmsportal/ODTLcjxAfvqbxHnVXCYX.png",content:Object(R.jsx)("div",{style:{width:700,minHeight:50,overflowX:"auto"},dangerouslySetInnerHTML:{__html:e.state.value}}),datetime:ve()().fromNow()}].concat(Object(je.a)(e.state.comments))});case 14:case"end":return t.stop()}}),t,null,[[3,8]])}))),e.handleChange=function(t){e.setState({value:t.target.value})},e}return Object(i.a)(n,[{key:"componentDidMount",value:function(){this._handleUpdateComments()}},{key:"render",value:function(){var e=this,t=this.state,n=t.comments,a=t.submitting;return Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)("br",{}),Object(R.jsx)(v.b,{align:"center",children:Object(R.jsx)(ye,{style:{margin:0,marginRight:10},level:5,children:"Discussion"})}),Object(R.jsx)(me.a,{}),Object(R.jsx)(fe.a,{avatar:Object(R.jsx)(xe.a,{src:"https://zos.alipayobjects.com/rmsportal/ODTLcjxAfvqbxHnVXCYX.png",alt:"Han Solo"}),content:Object(R.jsxs)(r.a.Fragment,{children:[Object(R.jsx)("style",{children:"\n                    .demo-editor {\n                        padding: 0px 10px 0px 10px;\n                        border-color: rgba(0,0,0,.1);\n                        border-style: solid;\n                        border-width: 1px;\n                        min-height: 120px;\n                        margin-bottom: 20px;\n                    }\n                    "}),Object(R.jsx)(G.Editor,{editorState:this.state.editorState,wrapperClassName:"demo-wrapper",editorClassName:"demo-editor",onEditorStateChange:function(t){e.setState({value:te()(Object(X.convertToRaw)(t.getCurrentContent())),editorState:t})}}),Object(R.jsx)(y.a,{htmlType:"submit",loading:a,onClick:this.handleSubmit,type:"primary",children:"Add Comment"})]})}),n.length>0&&Object(R.jsx)(we,{comments:n})]})}}]),n}(r.a.Component),ke=n(368),Se=n(371),Ie=K.a.Option,Ne=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={editTags:!1,editDueDate:!1,editReproducibility:!1,editSeverity:!1,editCatagory:!1,editStatus:!1,values:{tags:[" "],dueDate:null}},e.toggleValue=function(t){return e.setState(Object(Y.a)({},t,!e.state[t]))},e.updateStatistic=function(){var t=Object(h.a)(p.a.mark((function t(n,a){return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,C.a.put("/bug/"+e.props.bugId,Object(Y.a)({},n,a),{headers:D()});case 3:se.b.success('"'.concat(n,'" was updated to "').concat(a,'"')),t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),se.b.error("Error: "+I(t.t0));case 9:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(e,n){return t.apply(this,arguments)}}(),e}return Object(i.a)(n,[{key:"componentDidMount",value:function(){var e=this.props.bug;this.setState({values:{status:e.status,tags:""!==e.tags?e.tags.split(","):[],dueDate:e.dueDate?ve()(new Date(e.dueDate)):null,catagory:e.catagory?e.catagory:void 0,severity:e.severity?e.severity:void 0,reproducibility:e.reproducibility?e.reproducibility:void 0}})}},{key:"_forceUpdateBug",value:function(){}},{key:"render",value:function(){var e=this;return Object(R.jsx)(S.a,{maxWidth:800,children:function(t){return Object(R.jsxs)(R.Fragment,{children:[Object(R.jsxs)(W.a,{gutter:[0,40],children:[Object(R.jsx)(V.a,{span:t?12:8,children:Object(R.jsx)(q.a,{valueStyle:{fontSize:16},formatter:function(t){return e.state.editStatus?Object(R.jsx)(le.a,{checkedChildren:"OPEN",unCheckedChildren:"CLOSED",onChange:function(t){t?e.setState({values:Object(Q.a)(Object(Q.a)({},e.state.values),{},{status:"open"})}):e.setState({values:Object(Q.a)(Object(Q.a)({},e.state.values),{},{status:"closed"})})},defaultChecked:"open"===e.state.values.status}):Object(R.jsx)(ke.a,{color:"open"===e.state.values.status?"#f50":"#389e0d",children:(""+e.state.values.status).toUpperCase()})},title:Object(R.jsxs)(R.Fragment,{children:["Status",Object(R.jsx)(y.a,{onClick:function(){e.state.editStatus&&e.updateStatistic("status",e.state.values.status),e.toggleValue("editStatus")},type:"text",icon:Object(R.jsx)(Se.a,{})})]}),value:"OPEN"})}),Object(R.jsx)(V.a,{span:t?12:8,children:Object(R.jsx)(q.a,{valueStyle:{fontSize:16},title:Object(R.jsxs)(R.Fragment,{children:["Tags",Object(R.jsx)(y.a,{onClick:function(){e.state.editTags&&e.updateStatistic("tags",e.state.values.tags.join()),e.toggleValue("editTags")},type:"text",icon:Object(R.jsx)(Se.a,{})})]}),formatter:function(t){return e.state.editTags?Object(R.jsx)(K.a,{mode:"tags",onChange:function(t){e.setState({values:Object(Q.a)(Object(Q.a)({},e.state.values),{},{tags:t})})},value:e.state.values.tags,style:{width:200},placeholder:"Tags Mode",children:")"}):e.state.values.tags.map((function(e){return Object(R.jsx)(ke.a,{color:"cyan",children:e})}))},value:"URGENT"})}),Object(R.jsx)(V.a,{span:t?12:8,children:Object(R.jsx)(q.a,{valueStyle:{fontSize:16},title:Object(R.jsxs)(R.Fragment,{children:["Due Date",Object(R.jsx)(y.a,{onClick:function(){e.state.editDueDate&&e.state.values.dueDate&&e.updateStatistic("dueDate",e.state.values.dueDate.toDate().getTime()),e.toggleValue("editDueDate")},type:"text",icon:Object(R.jsx)(Se.a,{})})]}),formatter:function(t){return e.state.editDueDate?Object(R.jsx)(J.a,{style:{},value:e.state.values.dueDate,onChange:function(t){e.setState({values:Object(Q.a)(Object(Q.a)({},e.state.values),{},{dueDate:t})})}}):e.state.values.dueDate?e.state.values.dueDate.format("MMM Do YY"):"N/A"},value:"Oct 24, 2022"})}),Object(R.jsx)(V.a,{span:t?12:8,children:Object(R.jsx)(q.a,{valueStyle:{fontSize:16},title:Object(R.jsxs)(R.Fragment,{children:["Reproducibility",Object(R.jsx)(y.a,{type:"text",onClick:function(){e.state.editReproducibility&&e.updateStatistic("reproducibility",e.state.values.reproducibility),e.toggleValue("editReproducibility")},icon:Object(R.jsx)(Se.a,{})})]}),formatter:function(t){return e.state.editReproducibility?Object(R.jsxs)(K.a,{showSearch:!0,onChange:function(t){e.setState({values:Object(Q.a)(Object(Q.a)({},e.state.values),{},{reproducibility:t})})},value:e.state.values.reproducibility,style:{},placeholder:"Search to Select",optionFilterProp:"children",filterOption:function(e,t){return t.children.toLowerCase().indexOf(e.toLowerCase())>=0},filterSort:function(e,t){return e.children.toLowerCase().localeCompare(t.children.toLowerCase())},children:[Object(R.jsx)(Ie,{value:"Always",children:"Always"}),Object(R.jsx)(Ie,{value:"Sometimes",children:"Sometimes"}),Object(R.jsx)(Ie,{value:"Rarely",children:"Rarely"}),Object(R.jsx)(Ie,{value:"Unable",children:"Unable"}),Object(R.jsx)(Ie,{value:"Never tried",children:"Never tried"}),Object(R.jsx)(Ie,{value:"N/A",children:"N/A"})]}):e.state.values.reproducibility},value:"Always"})}),Object(R.jsx)(V.a,{span:t?12:8,children:Object(R.jsx)(q.a,{valueStyle:{fontSize:16},title:Object(R.jsxs)(R.Fragment,{children:["Severity",Object(R.jsx)(y.a,{type:"text",onClick:function(){e.state.editSeverity&&e.updateStatistic("severity",e.state.values.severity),e.toggleValue("editSeverity")},icon:Object(R.jsx)(Se.a,{})})]}),formatter:function(t){return e.state.editSeverity?Object(R.jsxs)(K.a,{showSearch:!0,style:{},placeholder:"Search to Select",optionFilterProp:"children",value:e.state.values.severity,onChange:function(t){e.setState({values:Object(Q.a)(Object(Q.a)({},e.state.values),{},{severity:t})})},filterOption:function(e,t){return t.children.toLowerCase().indexOf(e.toLowerCase())>=0},filterSort:function(e,t){return e.children.toLowerCase().localeCompare(t.children.toLowerCase())},children:[Object(R.jsx)(Ie,{value:"None",children:"None"}),Object(R.jsx)(Ie,{value:"Critical",children:"Critical"}),Object(R.jsx)(Ie,{value:"Major",children:"Major"}),Object(R.jsx)(Ie,{value:"Minor",children:"Minor"})]}):e.state.values.severity},value:"Major"})}),Object(R.jsx)(V.a,{span:t?12:8,children:Object(R.jsx)(q.a,{valueStyle:{fontSize:16},title:Object(R.jsxs)(R.Fragment,{children:["Catagory",Object(R.jsx)(y.a,{type:"text",onClick:function(){e.state.editCatagory&&e.updateStatistic("catagory",e.state.values.catagory),e.toggleValue("editCatagory")},icon:Object(R.jsx)(Se.a,{})})]}),formatter:function(t){return e.state.editCatagory?Object(R.jsxs)(K.a,{showSearch:!0,placeholder:"Search to Select",optionFilterProp:"children",onChange:function(t){e.setState({values:Object(Q.a)(Object(Q.a)({},e.state.values),{},{catagory:t})})},filterOption:function(e,t){return t.children.toLowerCase().indexOf(e.toLowerCase())>=0},value:e.state.values.catagory,filterSort:function(e,t){return e.children.toLowerCase().localeCompare(t.children.toLowerCase())},children:[Object(R.jsx)(Ie,{value:"Security",children:"Security"}),Object(R.jsx)(Ie,{value:"Data Loss",children:"Data Loss"}),Object(R.jsx)(Ie,{value:"Performance",children:"Performance"}),Object(R.jsx)(Ie,{value:"Crash/Hang",children:"Crash/Hang"}),Object(R.jsx)(Ie,{value:"Other Bug",children:"Other Bug"}),Object(R.jsx)(Ie,{value:"UI",children:"UI"}),Object(R.jsx)(Ie,{value:"New Feature",children:"New Feature"}),Object(R.jsx)(Ie,{value:"Enhancement",children:"Enhancement"})]}):e.state.values.catagory},value:"Crashes/Hang"})}),Object(R.jsx)(V.a,{span:t?12:8,children:Object(R.jsx)(q.a,{valueStyle:{fontSize:16},title:Object(R.jsx)("span",{style:{marginTop:10},children:"Owner"}),value:e.props.bug.submitter.name})}),Object(R.jsx)(V.a,{span:t?12:8,children:Object(R.jsx)(q.a,{valueStyle:{fontSize:16},title:"Date Submited",value:ve()(new Date(e.props.bug.createdAt)).format("MMM Do YY")})})]}),Object(R.jsx)("br",{})]})}})}}]),n}(r.a.Component),Me=n(360),De=n(369),Ae=f.a.Title,Ue=K.a.Option,Ee=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={editAssigned:!1,assignees:[],search:"",page:1,pageSize:10,total:0,query:"",members:[],selectedMembers:[]},e.TOKEN=window.localStorage.getItem("token"),e.fetchAssignees=Object(h.a)(p.a.mark((function t(){var n,a,r;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return""===(n=e.state.search)&&(n=void 0),t.prev=2,t.next=5,C.a.get("/bug/assignee",{headers:D(),params:{bugId:e.props.bug.id,search:n}});case 5:a=t.sent,r=a.data,e.setState({assignees:r.users,total:r.total}),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(2),console.error(I(t.t0));case 13:case"end":return t.stop()}}),t,null,[[2,10]])}))),e.paginate=function(t,n){0===t&&(t=1),e.setState({page:t,pageSize:n})},e.searchUsers=Object(h.a)(p.a.mark((function t(){var n,a,r,s,c;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.state.query,t.prev=1,t.next=4,C.a.get("/user/search",{params:{query:a,projectId:e.props.match.params.projectId,isIn:!0},headers:D()});case 4:n=t.sent,t.next=11;break;case 7:return t.prev=7,t.t0=t.catch(1),console.error(I(t.t0)),t.abrupt("return");case 11:for(r=[],s=n.data.results,c=0;c<s.length;c++)r.push({key:s[c].id,name:s[c].name,email:s[c].email,id:s[c].id});e.setState({members:r});case 15:case"end":return t.stop()}}),t,null,[[1,7]])}))),e.selectUser=function(t){e.setState({selectedMembers:t})},e.addAssignees=Object(h.a)(p.a.mark((function t(){var n;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.state.selectedMembers,t.prev=1,t.next=4,C.a.post("/bug/assignee",{assignees:n.join(","),bugId:e.props.bug.id},{headers:D()});case 4:e.setState({editAssigned:!1,page:1},e.fetchAssignees),se.b.success("Members added"),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(1),console.error(I(t.t0)),se.b.error("Error: "+I(t.t0));case 12:case"end":return t.stop()}}),t,null,[[1,8]])}))),e}return Object(i.a)(n,[{key:"componentDidMount",value:function(){this.fetchAssignees()}},{key:"render",value:function(){var e=this,t=this.state,n=t.page,a=t.pageSize,r=t.members;return Object(R.jsxs)("div",{children:[Object(R.jsx)(v.b,{align:"center",children:Object(R.jsx)(Ae,{style:{margin:0,marginRight:10},level:5,children:"Assigned To"})}),Object(R.jsx)(me.a,{}),Object(R.jsx)(ge.b,{size:"small",header:Object(R.jsxs)(v.b,{children:[Object(R.jsx)(O.a.Search,{onChange:function(t){e.setState({search:t.target.value},e.fetchAssignees)},placeholder:"search",style:{width:200}}),Object(R.jsx)(y.a,{icon:Object(R.jsx)(De.a,{}),onClick:function(){return e.setState({editAssigned:!0})},type:"primary"})]}),footer:Object(R.jsx)("div",{style:{width:"100%",display:"inline-flex",justifyContent:"flex-end"},children:Object(R.jsx)(Me.a,{size:"small",total:this.state.total,current:this.state.page,onChange:this.paginate,showSizeChanger:!0,showQuickJumper:!0})}),bordered:!0,dataSource:this.state.assignees,renderItem:function(e,t){var r;return t>=(n-1)*a&&t<(n-1)*a+a?Object(R.jsxs)(ge.b.Item,{children:[Object(R.jsx)(xe.a,{style:{color:"#f56a00",backgroundColor:"#fde3cf",marginRight:15},children:e.name.substring(0,1)}),"".concat(e.name.split(" ")[0]," ").concat(e.name.split(" ")[1]?e.name.split(" ")[1].substring(0,1).toUpperCase()+".":""," (").concat(e.email,")")]},null!==(r=e.id)&&void 0!==r?r:t):null}}),Object(R.jsx)(ce.a,{title:"Add More Members...",visible:this.state.editAssigned,onOk:function(){e.addAssignees(),e.fetchAssignees()},onCancel:function(){return e.setState({editAssigned:!1})},children:Object(R.jsx)(K.a,{showSearch:!0,mode:"multiple",placeholder:"search...",style:{width:"100%"},filterOption:!1,onSearch:function(t){e.setState({query:t},e.searchUsers)},onChange:this.selectUser,children:r.map((function(e){return Object(R.jsx)(Ue,{children:"".concat(e.name," (").concat(e.email,")")},e.id)}))})})]})}}]),n}(r.a.Component),Pe=Object(j.h)(Ee),Be=n(352),Te=n.n(Be),Re=n(353),Le=n.n(Re),Fe=f.a.Title,ze=f.a.Paragraph,_e=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).toggleFunc=function(e){a.setState(Object(Y.a)({},e,!a.state[e]))},a.updateDescription=function(){var e=Object(h.a)(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C.a.put("/bug/"+a.props.bug.id,{description:a.state.description},{headers:D()});case 3:se.b.success("Description was updated!"),e.next=11;break;case 6:e.prev=6,e.t0=e.catch(0),n=I(e.t0),console.error(n),n.error("Error: "+n);case 11:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),a.state={editDescription:!1,editorState:X.EditorState.createWithContent(X.ContentState.createFromBlockArray(Te()(a.props.bug.description))),description:""},a}return Object(i.a)(n,[{key:"componentDidMount",value:function(){this.setState({description:this.props.bug.description}),console.log(this.props.bug.description)}},{key:"render",value:function(){var e=this;return Object(R.jsxs)("div",{children:[Object(R.jsxs)(v.b,{align:"center",children:[Object(R.jsx)(Fe,{style:{margin:0,marginRight:10},level:5,children:"Description"}),Object(R.jsx)(y.a,{shape:"circle",onClick:function(){e.state.editDescription&&e.updateDescription(),e.toggleFunc("editDescription")},icon:Object(R.jsx)(Se.a,{})})]}),Object(R.jsx)(me.a,{}),this.state.editDescription?Object(R.jsxs)(r.a.Fragment,{children:[Object(R.jsx)("style",{children:"\n            .demo-editor {\n                padding: 0px 10px 0px 10px;\n                border-color: rgba(0,0,0,.1);\n                border-style: solid;\n                border-width: 1px;\n                min-height: 120px;\n                margin-bottom: 20px;\n            }\n            "}),Object(R.jsx)(G.Editor,{editorState:this.state.editorState,wrapperClassName:"demo-wrapper",editorClassName:"demo-editor",onEditorStateChange:function(t){e.setState({description:te()(Object(X.convertToRaw)(t.getCurrentContent())),editorState:t})}})]}):Object(R.jsx)(ze,{children:Object(R.jsx)("div",{dangerouslySetInnerHTML:{__html:Le.a.sanitize(this.state.description)}})}),Object(R.jsx)("br",{})]})}}]),n}(r.a.Component),We=f.a.Title,Ve=Z.a.Dragger,qe=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).toggleFunc=function(e){a.setState(Object(Y.a)({},e,!a.state[e]))},a.token=window.localStorage.getItem("token"),a.beforeUpload=function(){var e=Object(h.a)(p.a.mark((function e(t){var n,r,s,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=new FormData).append("files",t),e.prev=2,e.next=5,C.a.post("/file/",n,{headers:Object(Q.a)(Object(Q.a)({},D()),{},{"Content-Type":"multipart/form-data"}),params:{bugId:a.props.bug.id}});case 5:r=e.sent,s=r.data,t.isUploaded=!0,c=s.uploadedFiles[0].id,t.serverId=c,se.b.success('"'.concat(t.name,'" was uploaded!"')),a.setState({files:[].concat(Object(je.a)(a.state.files),[t])}),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(2),se.b.error("Error: "+I(e.t0));case 17:return e.abrupt("return",!1);case 18:case"end":return e.stop()}}),e,null,[[2,14]])})));return function(t){return e.apply(this,arguments)}}(),a._onFileDelete=function(){var e=Object(h.a)(p.a.mark((function e(t){var n,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=a.state.files,r=0;case 2:if(!(r<n.length)){e.next=19;break}if(n[r].uid!==t.uid){e.next=16;break}return e.prev=4,e.next=7,C.a.delete("/file/"+t.serverId,{headers:D()});case 7:se.b.success('"'.concat(t.name,'" was deleted!')),n.splice(r,1),a.setState({files:n}),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(4),se.b.error("Error: "+I(e.t0));case 15:return e.abrupt("break",19);case 16:r++,e.next=2;break;case 19:case"end":return e.stop()}}),e,null,[[4,12]])})));return function(t){return e.apply(this,arguments)}}(),a._onFileUpload=function(){},a.state={editFiles:!1,files:[],filesToRender:[]},a}return Object(i.a)(n,[{key:"componentDidMount",value:function(){var e=this.props.bug.files.map((function(e){var t=new File([],e.name);return t.uid=(new Date).getTime()+"-"+t.name,t.serverId=e.id,t.isUploaded=!0,t}));this.setState({files:e})}},{key:"render",value:function(){var e=this;return Object(R.jsxs)("div",{children:[Object(R.jsxs)(v.b,{align:"center",children:[Object(R.jsx)(We,{style:{margin:0,marginRight:10},level:5,children:"Files"}),Object(R.jsx)(y.a,{onClick:function(){return e.toggleFunc("editFiles")},shape:"circle",icon:Object(R.jsx)(Se.a,{})})]}),Object(R.jsx)(me.a,{}),this.state.editFiles?Object(R.jsxs)(Ve,{style:{marginBottom:20},multiple:!0,beforeUpload:this.beforeUpload,onRemove:this._onFileDelete,fileList:this.state.files,children:[Object(R.jsx)("p",{className:"ant-upload-drag-icon",children:Object(R.jsx)($.a,{})}),Object(R.jsx)("p",{className:"ant-upload-text",children:"Click or drag file to this area to upload"}),Object(R.jsx)("p",{className:"ant-upload-hint",children:"Support for a single or bulk upload. Strictly prohibit from uploading company data or other band files"})]}):Object(R.jsx)(ge.b,{bordered:!0,size:"small",dataSource:this.state.files,renderItem:function(e){return Object(R.jsx)(ge.b.Item,{children:Object(R.jsx)("a",{href:M+"/file/"+e.serverId,children:e.name})},e.serverId)}}),Object(R.jsx)("br",{})]})}}]),n}(r.a.Component),He=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={},a}return Object(i.a)(n,[{key:"render",value:function(){return Object(R.jsxs)("div",{children:[Object(R.jsx)(Ne,{bugId:this.props.bug.id,bug:this.props.bug}),Object(R.jsx)(_e,{bug:this.props.bug,description:this.props.bug.description}),Object(R.jsx)(qe,{bug:this.props.bug}),Object(R.jsx)(Pe,{bug:this.props.bug}),Object(R.jsx)(Ce,{bug:this.props.bug})]})}}]),n}(r.a.Component),Ye=n(646);function Qe(e){return e.length>100?e.substring(0,100)+"...":e}var Xe=Object(j.h)((function(e){var t=e.page,n=e.totalBugCount,a=e._handlePaginationChange,r=e.bugs,s=e.isMobile,c=e.viewBug,o=e.shareBug,i=e.deleteBug,l=function(e){return[Object(R.jsx)("a",{style:{margin:10},onClick:function(t){return c(t,e)},children:"view"},"list-loadmore-edit"),Object(R.jsx)("a",{style:{margin:10},onClick:function(t){return o(t,e)},children:"share"},"list-loadmore-edit"),Object(R.jsx)(Ye.a,{title:"Are you sure?",onConfirm:function(){return i(e.id)},children:Object(R.jsx)("a",{style:{color:"red",marginLeft:10},onClick:function(e){e.preventDefault()},children:"delete"},"list-loadmore-edit")})]};return Object(R.jsxs)(R.Fragment,{children:[s&&Object(R.jsx)("style",{children:"\n    #bugg-bugs-list .ant-list-item-action {\n        justify-content: space-evenly;\n    display: inline-flex;\n    width: 100%;\n    }\n    "}),Object(R.jsx)(ge.b,{style:{maxWidth:1e3},id:"bugg-bugs-list",pagination:{current:t,defaultCurrent:1,total:n,onChange:a},itemLayout:s?"vertical":"horizontal",dataSource:r,renderItem:function(e){return Object(R.jsxs)(ge.b.Item,{actions:l(e),children:[Object(R.jsx)(ge.b.Item.Meta,{title:Object(R.jsxs)("div",{style:{display:"inline"},children:[Object(R.jsx)(ke.a,{color:"open"===e.status?"#f50":"#389e0d",children:e.status.toUpperCase()}),Object(R.jsx)("a",{href:"#",onClick:function(t){return c(t,e)},children:e.title})]}),description:Qe(e.plainTextDescription)}),Object(R.jsx)("div",{children:"Last modified "+ve()(new Date(e.updatedAt)).fromNow()})]},e.id)}})]})})),Ge=function(e){throw new Error(I(e))},Je={getAnnouncement:function(){var e=Object(h.a)(p.a.mark((function e(t){var n,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C.a.get(M+"/announcement",{headers:D(),params:{announcementId:t}});case 3:return n=e.sent,a=n.data.announcement,e.abrupt("return",a);case 8:e.prev=8,e.t0=e.catch(0),Ge(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()},Ke=function(e){throw new Error(I(e))},Ze={getBug:function(){var e=Object(h.a)(p.a.mark((function e(t){var n,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C.a.get(M+"/bug/"+t,{headers:D()});case 3:return n=e.sent,a=n.data.bug,e.abrupt("return",a);case 8:e.prev=8,e.t0=e.catch(0),Ke(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),deleteBug:function(){var e=Object(h.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C.a.delete(M+"/bug/"+t,{headers:D()});case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),Ke(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}()};var $e={leaveProject:function(){var e=Object(h.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C.a.delete(M+"/project/member/me",{headers:D(),params:{projectId:t}});case 3:e.next=8;break;case 5:throw e.prev=5,e.t0=e.catch(0),new Error(I(e.t0));case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}()},et=function(e){throw new Error(I(e))},tt={getConversations:function(){var e=Object(h.a)(p.a.mark((function e(){var t,n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C.a.get(M+"/conversation/all",{headers:D()});case 3:return t=e.sent,n=t.data.conversations,e.abrupt("return",n);case 8:e.prev=8,e.t0=e.catch(0),et(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),readAllMessages:function(){var e=Object(h.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C.a.patch(M+"/message/read/"+t,{},{headers:D()});case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),et(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}()},nt=function(e){throw new Error(I(e))},at={getUnreadNotifications:function(){var e=Object(h.a)(p.a.mark((function e(){var t,n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C.a.get(M+"/notification/all",{headers:D(),params:{limit:0,skip:0}});case 3:return t=e.sent,n=t.data.totalUnreadNotifcations,e.abrupt("return",n);case 8:e.prev=8,e.t0=e.catch(0),nt(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}()};function rt(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{name:"",email:"",id:"",iconId:""};this.name=e.name,this.email=e.email,this.id=e.id,this.iconId=e.iconId}var st=function(e){throw new Error(I(e))},ct=function(){var e=Object(h.a)(p.a.mark((function e(){var t,n,a,r,s,c,o,i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C.a.get(M+"/user/me",{headers:D()});case 3:return t=e.sent,n=t.data,a=n.user,r=a.id,s=a.name,c=a.email,o=a.iconId,i={id:r,name:s,email:c,iconId:o},e.abrupt("return",new rt(i));case 10:throw e.prev=10,e.t0=e.catch(0),new Error(I(e.t0));case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}();var ot=function(){var e=Object(h.a)(p.a.mark((function e(t,n){var a,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("email"!==t||/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(n).toLowerCase())){e.next=2;break}throw new Error("Email is invalid");case 2:return e.prev=2,e.next=5,C.a.put(M+"/user/update",Object(Y.a)({},t,n),{headers:D()});case 5:return a=e.sent,r=a.data.user,e.abrupt("return",new rt(r));case 10:e.prev=10,e.t0=e.catch(2),st(e.t0);case 13:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t,n){return e.apply(this,arguments)}}(),it=function(){var e=Object(h.a)(p.a.mark((function e(t,n){var a,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C.a.patch(M+"/user/password",{password:t,newPassword:n},{headers:D()});case 3:return a=e.sent,r=a.data,e.abrupt("return",r.token);case 8:e.prev=8,e.t0=e.catch(0),st(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,n){return e.apply(this,arguments)}}(),lt=function(){var e=Object(h.a)(p.a.mark((function e(t){var n,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ct();case 3:if(n=e.sent,!(a=n.iconId)){e.next=9;break}return e.abrupt("return",M+"/user/icon/"+a);case 9:return e.abrupt("return","");case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),st(e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t){return e.apply(this,arguments)}}(),ut={getMe:ct,updateUser:ot,updatePassword:it,getUserIconUri:lt,uploadUserIcon:function(){var e=Object(h.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t){e.next=3;break}throw new Error("Must have formData");case 3:return e.next=5,C.a.post(M+"/user/icon",t,{headers:Object(Q.a)(Object(Q.a)({},D()),{},{"Content-Type":"multipart/form-data"})});case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),st(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()};function dt(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{name:"",email:"",id:""};this.name=e.name,this.email=e.email,this.id=e.id}var pt=function(){var e=Object(h.a)(p.a.mark((function e(){var t,n,a,r,s,c,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C.a.get(M+"/user/me",{headers:D()});case 3:return t=e.sent,n=t.data,a=n.user,r=a.id,s=a.name,c=a.email,o={id:r,name:s,email:c},e.abrupt("return",new dt(o));case 10:throw e.prev=10,e.t0=e.catch(0),new Error(I(e.t0));case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}(),ht={getMe:pt,User:ut,Notification:at,Message:tt,Bug:Ze,Announcement:Je,Project:$e},bt=O.a.Search,jt="#1890ff",gt=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e))._handlePaginationChange=function(e,t){e===a.state.page&&t===a.state.pageSize||a.setState({page:e,pageSize:t},a.fetchBugs)},a.deleteBug=function(){var e=Object(h.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ht.Bug.deleteBug(t);case 3:a.fetchBugs(),se.b.success("Bug was deleted"),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),se.b.error("Bug could not be deleted: "+I(e.t0));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),a.fetchBugs=Object(h.a)(p.a.mark((function e(){var t,n,r,s,c,o,i,l,u,d,h,b;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(t=a.props.location.pathname.split("/"))[t.length-1],n=a.state,r=n.pageSize,s=n.page,(c=n.search)?s=1:c=void 0,l=a.state,u=l.selectedSort,d=l.checked,"1"===u?i="upload-date":"2"===u?i="title":"3"===u&&(i="last-modified"),"0"!==u&&(o=d?"ASC":"DESC"),e.prev=7,e.next=10,C.a.get("/bug/all",{headers:D(),params:{projectId:t,limit:r,skip:r*(s-1),search:c,sortBy:i,order:o}});case 10:h=e.sent,b=h.data,a.setState({bugs:b.bugs,totalBugCount:b.total,page:s}),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(7),N(e.t0);case 18:case"end":return e.stop()}}),e,null,[[7,15]])}))),a.openBug=function(){var e=Object(h.a)(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ht.Bug.getBug(t);case 3:if(n=e.sent){e.next=6;break}throw new Error("Bug not found");case 6:a.props.history.push(a.props.location.pathname),a.setState({selectedBug:n,toggleDrawer:!0,selectedBugTitle:n.title}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),x.a.error({message:I(e.t0)});case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),a.handleActionUri=function(){var e=a.props.location,t=new URLSearchParams(e.search);"OPEN_BUG"===t.get("action")&&null!==t.get("bugId")&&a.openBug(t.get("bugId"))},a.toggleFunc=function(e){a.setState(Object(Y.a)({},e,!a.state[e]))},a._handleSortChange=function(e){e.key===a.state.selectedSort?a.setState({selectedSort:"0",page:1},a.fetchBugs):a.setState({selectedSort:e.key,page:1},a.fetchBugs)},a.state={toggleCreatePopup:!1,toggleViewBugPopup:!1,toggleDrawer:!1,totalBugCount:0,pageSize:10,searchQuery:"",sortBy:"",page:1,bugs:[],selectedSort:"0",checked:!0,selectedBug:null,selectedBugTitle:"",search:""},a}return Object(i.a)(n,[{key:"componentDidMount",value:function(){this.fetchBugs(),this.handleActionUri()}},{key:"componentDidUpdate",value:function(e){if(this.props.location!==e.location){var t=this.props.location.pathname.split("/");t=t[t.length-1],this.setState({search:"",page:1},this.fetchBugs),this.handleActionUri()}}},{key:"render",value:function(){for(var e=this,t=[],n=0;n<10;n++)t.push({bugId:"y938cbu9",title:"Videos will not play",state:"priority",loading:!1});return Object(R.jsx)(S.a,{maxWidth:800,children:function(t){return Object(R.jsxs)("div",{children:[Object(R.jsxs)("div",{style:{marginBottom:20,gap:6,display:"flex",flexWrap:"wrap"},children:[Object(R.jsx)(y.a,{type:"primary",onClick:function(){return e.toggleFunc("toggleCreatePopup")},children:"Submit New"}),Object(R.jsx)(y.a,{onClick:e.fetchBugs,children:"Refresh"}),Object(R.jsx)(bt,{value:e.state.search,placeholder:"Search",onChange:function(t){e.setState({search:t.target.value},e.fetchBugs)},onSearch:function(t){e.fetchBugs()},style:{width:200}}),Object(R.jsx)(ie.a,{overlay:(n={selectedSort:e.state.selectedSort,handleChange:e._handleSortChange},Object(R.jsxs)(oe.a,{onClick:n.handleChange,children:[Object(R.jsx)(oe.a.Item,{icon:Object(R.jsx)(de.a,{style:{color:"1"===n.selectedSort?jt:"unset"}}),children:Object(R.jsx)("span",{style:{color:"1"===n.selectedSort?jt:"unset"},children:"Upload Date"})},"1"),Object(R.jsx)(oe.a.Item,{icon:Object(R.jsx)(pe.a,{style:{color:"2"===n.selectedSort?jt:"unset"}}),children:Object(R.jsx)("span",{style:{color:"2"===n.selectedSort?jt:"unset"},children:"Title"})},"2"),Object(R.jsx)(oe.a.Item,{icon:Object(R.jsx)(he.a,{style:{color:"3"===n.selectedSort?jt:"unset"}}),children:Object(R.jsx)("span",{style:{color:"3"===n.selectedSort?jt:"unset"},children:"Last Modified"})},"3")]})),children:Object(R.jsxs)(y.a,{children:["Sort By ",Object(R.jsx)(be.a,{})]})}),"0"!==e.state.selectedSort?Object(R.jsx)(le.a,{checkedChildren:"ASC",unCheckedChildren:"DESC",defaultChecked:!0,onChange:function(t){e.setState({page:1,checked:t},e.fetchBugs)}}):null]}),Object(R.jsx)(ce.a,{destroyOnClose:!0,title:"Submit New Bug",visible:e.state.toggleCreatePopup,width:900,footer:null,onCancel:function(){return e.toggleFunc("toggleCreatePopup")},children:Object(R.jsx)(re,{_handleListUpdate:e.fetchBugs,toggleFunc:function(){return e.toggleFunc("toggleCreatePopup")}})}),Object(R.jsx)("div",{style:{marginRight:t?10:64},children:Object(R.jsx)(Xe,{page:e.state.page,totalBugCount:e.state.totalBugCount,_handlePaginationChange:e._handlePaginationChange,bugs:e.state.bugs,isMobile:t,viewBug:function(t,n){e.setState({toggleDrawer:!0,selectedBugTitle:n.title,selectedBug:n}),t.preventDefault()},shareBug:function(){var e=Object(h.a)(p.a.mark((function e(t,n){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),a=A+"/dashboard/projects/"+n.project+"?action=OPEN_BUG&bugId="+n.id,!navigator.clipboard){e.next=8;break}return e.next=5,navigator.clipboard.writeText(a);case 5:se.b.success("Link copied to clipboard!"),e.next=10;break;case 8:window.Clipboard.copy(a),se.b.success("Link copied to clipboard!");case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),deleteBug:e.deleteBug})}),Object(R.jsx)(ue.a,{width:t?"100%":800,title:e.state.selectedBugTitle,placement:"right",closable:!0,onClose:function(){e.fetchBugs(),e.setState({toggleDrawer:!1})},visible:e.state.toggleDrawer,destroyOnClose:!0,children:Object(R.jsx)(He,{bug:e.state.selectedBug})})]});var n}})}}]),n}(r.a.Component);window.Clipboard=function(e,t,n){var a;function r(){var r,s;n.userAgent.match(/ipad|iphone/i)?((r=t.createRange()).selectNodeContents(a),(s=e.getSelection()).removeAllRanges(),s.addRange(r),a.setSelectionRange(0,999999)):a.select()}return{copy:function(e){!function(e){(a=t.createElement("textArea")).value=e,t.body.appendChild(a)}(e),r(),t.execCommand("copy"),t.body.removeChild(a)}}}(window,document,navigator);var ft=Object(j.h)(gt),mt=n(350),xt=n(145),Ot=n(667);var vt=function(e){var t=Object(a.useState)(X.EditorState.createEmpty()),n=Object(b.a)(t,2),r=n[0],s=n[1],c=m.a.useForm(),o=Object(b.a)(c,1)[0],i=function(){var t=Object(h.a)(p.a.mark((function t(n){var a,s;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=n.title,s=te()(Object(X.convertToRaw)(r.getCurrentContent())),t.prev=2,t.next=5,C.a.post("/announcement",{projectId:e.project.id,title:a,body:s},{headers:D()});case 5:se.b.success("Announcement was created"),e.closeModal(),e.updateList(),t.next=14;break;case 10:t.prev=10,t.t0=t.catch(2),console.error(I(t.t0)),se.b.error("Error: "+I(t.t0));case 14:case"end":return t.stop()}}),t,null,[[2,10]])})));return function(e){return t.apply(this,arguments)}}();return Object(R.jsx)("div",{children:Object(R.jsx)(v.b,{direction:"vertical",style:{width:"100%"},children:Object(R.jsxs)(m.a,{layout:"vertical",onFinish:i,form:o,children:[Object(R.jsx)(m.a.Item,{label:"Title",name:"title",rules:[{required:!0,message:"Please add a title"}],children:Object(R.jsx)(O.a,{type:"text"})}),Object(R.jsx)("style",{children:"\n                    .demo-editor {\n                        padding: 0px 10px 0px 10px;\n                        border-color: rgba(0,0,0,.1);\n                        border-style: solid;\n                        border-width: 1px;\n                        min-height: 150px\n                    }\n                    "}),Object(R.jsx)(m.a.Item,{label:"Body",name:"body",children:Object(R.jsx)(G.Editor,{editorState:r,wrapperClassName:"demo-wrapper",editorClassName:"demo-editor",onEditorStateChange:s})}),Object(R.jsxs)(v.b,{style:{width:"100%",marginTop:20,display:"inline-flex",justifyContent:"flex-end"},children:[Object(R.jsx)(y.a,{onClick:e.closeModal,children:"Cancel"}),Object(R.jsx)(y.a,{htmlType:"submit",type:"primary",children:"Create"})]})]})})})},yt=n(354),wt=n.n(yt),Ct=O.a.Search;function kt(e){return null===e.announcement?null:Object(R.jsxs)(R.Fragment,{children:[Object(R.jsxs)("div",{style:{display:"inline-flex",alignItems:"center"},children:[Object(R.jsx)(xe.a,{size:64,style:{marginRight:20},icon:Object(R.jsx)(Ot.a,{})}),Object(R.jsxs)("span",{children:[Object(R.jsx)("p",{style:{margin:0,fontSize:18},children:Object(R.jsx)("b",{children:e.announcement.submitter.name})}),Object(R.jsx)("p",{style:{margin:0},children:"Director"})]}),Object(R.jsx)("span",{children:Object(R.jsx)(y.a,{type:"text",style:{color:"#1890ff",marginLeft:20},children:"Reply"})})]}),Object(R.jsx)(me.a,{}),Object(R.jsx)("h1",{children:e.announcement.title}),Object(R.jsx)("p",{dangerouslySetInnerHTML:{__html:e.announcement.body},style:{maxWidth:700}})]})}var St=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).formatName=function(e){var t=e.split(" "),n=t[0];return t[1]&&(n+=" "+t[1].substring(0,1).toUpperCase()+"."),n},a.handleOpenAnnouncement=Object(h.a)(p.a.mark((function e(){var t,n,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.props.location,"OPEN_ANNOUNCEMENT"!==(n=new URLSearchParams(t.search)).get("action")||!n.has("announcementId")){e.next=19;break}return e.prev=3,e.next=6,ht.Announcement.getAnnouncement(n.get("announcementId"));case 6:if(r=e.sent){e.next=9;break}throw new Error("Announcement not found");case 9:a.props.history.push(t.pathname),a.setState({selectedAnnouncement:r}),a.fetchAndSetAnnouncements(),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(3),x.a.error({message:I(e.t0)});case 17:e.next=19;break;case 19:case"end":return e.stop()}}),e,null,[[3,14]])}))),a.fetchAndSetAnnouncements=function(){var e=Object(h.a)(p.a.mark((function e(t){var n,r,s,c,o,i,l,u,d;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.state,r=n.announcements,s=n.search,c=n.sortBy,o=r.length,t&&(o=0),5,e.prev=4,i=(i=a.props.location.pathname.split("/"))[i.length-1],e.next=9,C.a.get("/announcement/",{headers:D(),params:{projectId:i,limit:5,skip:o,search:s,sortBy:c}});case 9:l=e.sent,u=l.data,console.log(u),d=t?u.announcements:[].concat(Object(je.a)(r),Object(je.a)(u.announcements)),a.setState({total:u.total,announcements:d,hasMore:!0}),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(4),N(e.t0);case 19:case"end":return e.stop()}}),e,null,[[4,16]])})));return function(t){return e.apply(this,arguments)}}(),a.onSearch=function(){var e=Object(h.a)(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=!1,t!==a.state.search&&(n=!0),a.setState({search:t},(function(){return a.fetchAndSetAnnouncements(n)}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.handleInfiniteLoad=Object(h.a)(p.a.mark((function e(){var t,n,r,s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.state,n=t.announcements,r=t.total,s=t.firstLoad,a.setState({loading:!0}),console.log("State: "),console.log(a.state),n.length!==r||!1!==s){e.next=7;break}return a.setState({hasMore:!1,loading:!1}),e.abrupt("return");case 7:return console.log("EXEC"),e.next=10,a.fetchAndSetAnnouncements();case 10:a.setState({loading:!1,firstLoad:!1});case 11:case"end":return e.stop()}}),e)}))),a.toggleState=function(e){return a.setState(Object(Y.a)({},e,!a.state[e]))},a.state={isAuthed:!1,createAnnouncement:!1,selectedAnnouncement:null,announcements:[],total:0,loading:!1,search:"",sortBy:"",hasMore:!0,firstLoad:!0},a}return Object(i.a)(n,[{key:"componentDidMount",value:function(){var e=Object(h.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.handleOpenAnnouncement();case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(e){this.props.location!==e.location&&(this.fetchAndSetAnnouncements(!0),this.handleOpenAnnouncement());var t=this.props.location.pathname.split("/");t=t[t.length-1],this.state.selectedAnnouncement&&t!==this.state.selectedAnnouncement.project&&this.setState({selectedAnnouncement:null})}},{key:"render",value:function(){var e=this;return Object(R.jsx)(S.a,{maxWidth:800,children:function(t){return Object(R.jsxs)("div",{children:[Object(R.jsx)(ce.a,{title:"Create New Announcement",visible:e.state.createAnnouncement,destroyOnClose:!0,footer:null,style:{width:t?"90%":800},onCancel:function(){return e.toggleState("createAnnouncement")},onOk:function(){return e.toggleState("createAnnouncement")},children:Object(R.jsx)(vt,{project:e.props.project,closeModal:function(){return e.toggleState("createAnnouncement")},updateList:function(){return e.fetchAndSetAnnouncements(!0)}})}),Object(R.jsxs)("div",{style:{marginBottom:20,gap:6,display:"flex",flexWrap:"wrap"},children:[Object(R.jsx)(y.a,{onClick:function(){return e.toggleState("createAnnouncement")},type:"primary",children:"New Announcement"}),Object(R.jsx)(y.a,{onClick:function(){return e.fetchAndSetAnnouncements(!0)},children:"Refresh"}),Object(R.jsx)(Ct,{placeholder:"search",onChange:function(t){return e.onSearch(t.target.value)},onSearch:function(t){return e.onSearch(t)},style:{width:200}})]}),Object(R.jsx)("style",{children:"\n.bugg-list-item-button-321312312:hover {\n    background-color: rgb(0 0 0 / 5%);\n    cursor: pointer;\n}\n.bugg-list-item-button-321312312 {\n    background-color: white;\n}\n"}),Object(R.jsxs)("div",{style:{display:t?"flex":"inline-flex",flexDirection:t?"column":"unset",marginRight:t?10:"unset"},children:[Object(R.jsx)("div",{style:{borderColor:"rgba(0,0,0,.2)",borderStyle:"solid",borderWidth:1,borderRadius:5,width:t?"unset":360,height:600,overflowY:"auto",overflowClipBox:"content-box"},children:Object(R.jsxs)(wt.a,{initialLoad:!0,pageStart:0,loadMore:e.handleInfiniteLoad,hasMore:!e.state.loading&&e.state.hasMore,useWindow:!1,children:[Object(R.jsx)(ge.b,{itemLayout:"horizontal",dataSource:e.state.announcements,renderItem:function(t){return Object(R.jsx)(ge.b.Item,{className:"bugg-list-item-button-321312312",onClick:function(){e.setState({selectedAnnouncement:t})},children:Object(R.jsx)(ge.b.Item.Meta,{avatar:Object(R.jsx)(xe.a,{style:{marginLeft:20,marginTop:9},children:t.submitter.name.substring(0,1).toUpperCase()}),title:Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)("a",{style:{marginRight:10},onClick:function(e){return e.preventDefault()},href:"#",children:e.formatName(t.submitter.name)}),Object(R.jsx)(ke.a,{color:"#f50",children:"OWNER"}),Object(R.jsx)("span",{style:{float:"right",marginRight:20,opacity:.8},children:ve()(new Date(t.createdAt)).format("LT")})]}),description:t.plainTextBody})},t.id)}}),e.state.loading&&e.state.hasMore&&Object(R.jsx)("div",{className:"demo-loading-container",children:Object(R.jsx)(mt.a,{})})]})}),Object(R.jsx)("style",{children:"\n                    .demo-loading-container {\n                        position: relative;\n                        bottom: 0px;\n                        background-color: white;\n                        width: 100%;\n                        text-align: center;\n                      }\n                    "}),!t&&Object(R.jsx)("div",{style:{flex:1,marginLeft:20,width:600,minHeight:600},children:null===e.state.selectedAnnouncement?Object(R.jsx)(xt.a,{style:{marginTop:100},description:"Select an announcement to view"}):Object(R.jsx)(kt,{announcement:e.state.selectedAnnouncement})}),t&&Object(R.jsx)(ue.a,{visible:null!==e.state.selectedAnnouncement,onClose:function(){return e.setState({selectedAnnouncement:null})},destroyOnClose:!0,width:"90%",title:"View Announcement",children:Object(R.jsx)(kt,{announcement:e.state.selectedAnnouncement})})]})]})}})}}]),n}(r.a.Component),It=Object(j.h)(St),Nt=n(654),Mt=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).fetchBugs=Object(h.a)(p.a.mark((function e(){var t,n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.props.project.id){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,C.a.get("/bug/all",{headers:D(),params:{projectId:a.props.project.id}});case 5:t=e.sent,n=t.data,a.setState({bugs:n.bugs.map((function(e){var t;return e.dueDate&&(t=ve()(new Date(e.dueDate))),Object(Q.a)(Object(Q.a)({},e),{},{date:t})}))}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),N(e.t0);case 13:case"end":return e.stop()}}),e,null,[[2,10]])}))),a._onDateSelected=function(e){console.log(e),a._toggleDrawerState()},a._toggleDrawerState=function(){a.setState({toggleDrawer:!a.state.toggleDrawer})},a._onDrawerClose=function(){a._toggleDrawerState(),a.fetchBugs()},a._onBugSelect=function(){a.state.selectedBug;a._toggleDrawerState()},a.getBugsDue=function(e){for(var t=e.year(),n=e.dayOfYear(),r=[],s=a.state.bugs,c=0;c<s.length;c++){var o=s[c].date;o&&(t===o.year()&&n===o.dayOfYear()&&r.push(s[c]))}return r},a.dateCellRender=function(e){var t=a.getBugsDue(e);return Object(R.jsx)("ul",{className:"events",children:t.map((function(e){return Object(R.jsx)("li",{onClick:function(){return a.setState({selectedBug:e},a._onBugSelect)},style:{backgroundColor:function(){var t=e.type;return"error"===t?"#f5222d":"warning"===t?"#d4b106":"success"===t?"#52c41a":"#13c2c2"}(),marginBottom:5,borderRadius:5,paddingLeft:5,color:"white"},children:e.title},e.id)}))})},a.state={createNewEvent:!1,toggleDrawer:!1,bugs:[],selectedBug:{},selectedDate:ve()()},a}return Object(i.a)(n,[{key:"componentDidMount",value:function(){this.fetchBugs()}},{key:"componentDidUpdate",value:function(e){e.project.id!==this.props.project.id&&this.fetchBugs()}},{key:"render",value:function(){var e=this;return Object(R.jsx)(S.a,{maxWidth:800,children:function(t){return Object(R.jsx)("div",{children:Object(R.jsxs)("div",{style:{marginRight:t?10:64},children:[Object(R.jsx)("style",{children:"\n                    .events {\n                        margin: 0;\n                        padding: 0;\n                        list-style: none;\n                      }\n                      .events .ant-badge-status {\n                        width: 100%;\n                        overflow: hidden;\n                        font-size: 12px;\n                        white-space: nowrap;\n                        text-overflow: ellipsis;\n                      }\n                      .notes-month {\n                        font-size: 28px;\n                        text-align: center;\n                      }\n                      .notes-month section {\n                        font-size: 28px;\n                      }\n                    "}),Object(R.jsx)(v.b,{children:Object(R.jsx)(y.a,{type:"primary",onClick:function(){return e.setState({selectedDate:ve()()})},children:"Today"})}),Object(R.jsx)(Nt.a,{value:e.state.selectedDate,onSelect:function(t){return e.setState({selectedDate:t})},dateCellRender:e.dateCellRender}),Object(R.jsx)(ce.a,{visible:e.state.createNewEvent,onOk:function(){return e.setState({createNewEvent:!e.state.createNewEvent})},onCancel:function(){return e.setState({createNewEvent:!e.state.createNewEvent})},title:"Create New Event"}),Object(R.jsx)(ue.a,{width:800,title:"View Date",placement:"right",closable:!0,onClose:function(){return e.setState({toggleDrawer:!1})},visible:e.state.toggleDrawer,children:"hey"}),Object(R.jsx)(ue.a,{width:t?"100%":800,title:e.state.selectedBug.title,placement:"right",closable:!0,onClose:e._onDrawerClose,visible:e.state.toggleDrawer,destroyOnClose:!0,children:Object(R.jsx)(He,{bug:e.state.selectedBug})})]})})}})}}]),n}(r.a.Component);var Dt=Object(j.h)((function(e){var t=function(){A(e.project),c(e.project.title),u(e.project.description);try{m("/icon/"+e.project.icon[0].id)}catch(t){}(function(){var t=Object(h.a)(p.a.mark((function t(){var n,a;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,C.a.get("/project/find",{headers:D(),params:{projectId:e.project.id}});case 3:n=t.sent,(a=n.data).project&&(console.log(a.project),A(a.project),m(M+"/icon/"+a.project.icon[0].id),c(a.project.title),u(a.project.description)),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),N(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(){return t.apply(this,arguments)}})()()};Object(a.useEffect)(t,[e.project]);var n=Object(a.useState)(""),r=Object(b.a)(n,2),s=r[0],c=r[1],o=Object(a.useState)(""),i=Object(b.a)(o,2),l=i[0],u=i[1],d=Object(a.useState)(""),g=Object(b.a)(d,2),f=g[0],m=g[1],w=Object(a.useState)({}),k=Object(b.a)(w,2),S=k[0],A=k[1],E=function(){var t=Object(h.a)(p.a.mark((function t(n){var a,r,s,c;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(a=new FormData).append("icon",n),t.prev=2,t.next=5,C.a.post("/icon/upload",a,{headers:Object(Q.a)(Object(Q.a)({},D()),{},{"Content-Type":"multipart/form-data"}),params:{projectId:S.id}});case 5:r=t.sent,s=r.data,console.log(s),c=M+"/icon/"+s.uploadedFiles[0].id,e.updateProject(),m(c),se.b.success("Icon was updated"),t.next=18;break;case 14:t.prev=14,t.t0=t.catch(2),N(t.t0),se.b.error("Error: "+I(t.t0));case 18:return t.abrupt("return",!1);case 19:case"end":return t.stop()}}),t,null,[[2,14]])})));return function(e){return t.apply(this,arguments)}}(),P=function(){var t=Object(h.a)(p.a.mark((function t(n){var a,r,c,o;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"title"===n?a=s:"description"===n&&(a=l),t.prev=1,t.next=4,C.a.put("/project/"+S.id,Object(Y.a)({},n,a),{headers:D()});case 4:r=t.sent,c=r.data,o=c.project,A(o),se.b.success("".concat(n,' was updated to "').concat(a,'"')),e.updateProject(),t.next=16;break;case 12:t.prev=12,t.t0=t.catch(1),N(t.t0),se.b.error("Error: "+I(t.t0));case 16:case"end":return t.stop()}}),t,null,[[1,12]])})));return function(e){return t.apply(this,arguments)}}(),B=Object(j.g)(),T=function(){var t=Object(h.a)(p.a.mark((function t(){var n;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.project.id,t.prev=1,t.next=4,C.a.delete(U.baseUrl+"/project/"+n,{headers:U.getDefaultHeader()});case 4:x.a.success({message:"Project was deleted"}),e.updateProjectOnNavigation(),B.push("/dashboard"),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),N(t.t0),se.b.error("Error: "+I(t.t0));case 13:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(){return t.apply(this,arguments)}}();Object(a.useEffect)(t,[]);var L=function(){var t=Object(h.a)(p.a.mark((function t(){var n;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.match.params.projectId,t.prev=1,t.next=4,ht.Project.leaveProject(n);case 4:e.history.push("/dashboard"),se.b.success("Left project"),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),se.b.error("Could not leave project: "+I(t.t0));case 11:case"end":return t.stop()}}),t,null,[[1,8]])})));return function(){return t.apply(this,arguments)}}(),F=[{title:"Title",reactNode:Object(R.jsxs)(v.b,{children:[s!==S.title?Object(R.jsx)(y.a,{onClick:function(){return P("title")},type:"primary",children:"Update"}):null,Object(R.jsx)(O.a,{value:s,onPressEnter:function(){s!==S.title&&P("title")},onChange:function(e){c(e.target.value)},type:"text"})]})},{title:"Description",reactNode:Object(R.jsxs)(v.b,{children:[l!==S.description?Object(R.jsx)(y.a,{onClick:function(){return P("description")},type:"primary",children:"Update"}):null,Object(R.jsx)(O.a,{value:l,onPressEnter:function(){l!==S.description&&P("description")},onChange:function(e){u(e.target.value)},o:!0,type:"text"})]})},{title:"Project Icon",reactNode:Object(R.jsx)("div",{children:Object(R.jsx)(Z.a,{name:"avatar",listType:"picture-card",accept:"image/*",showUploadList:!1,beforeUpload:E,children:""===f?"Upload Icon":Object(R.jsx)("div",{style:{width:"80%",height:"80%",backgroundImage:"url("+f+")",backgroundSize:"cover",backgroundPosition:"center"}})})})},{title:"Leave Project?",reactNode:Object(R.jsx)(Ye.a,{title:"Are you sure?",onConfirm:L,children:Object(R.jsx)(y.a,{danger:!0,children:"Leave"})})},{title:"Delete Project?",reactNode:Object(R.jsx)(Ye.a,{title:"Are you sure?",onConfirm:T,children:Object(R.jsx)(y.a,{danger:!0,children:"Delete"})})}];return Object(R.jsx)("div",{style:{width:"100%"},children:Object(R.jsx)(ge.b,{style:{width:"100%",maxWidth:600},dataSource:F,bordered:!0,renderItem:function(e){return Object(R.jsx)(ge.b.Item,{extra:[e.reactNode],children:e.title},e.title)}})})})),At=n(204),Ut="ALL",Et="MODIFY_GENERAL",Pt="MODIFY_MEMBERS",Bt="MODIFY_BUGS",Tt="MODIFY_ANNOUNCEMENTS",Rt=K.a.Option,Lt=Object(j.h)((function(e){Object(a.useEffect)((function(){e.role&&(s(e.role.users),l(e.role.users.map((function(e){return e.id}))),e.role.color&&N(e.role.color))}),[e.role]);var t=Object(a.useState)([]),n=Object(b.a)(t,2),r=n[0],s=n[1],c=Object(a.useState)([]),o=Object(b.a)(c,2),i=o[0],l=o[1],u=Object(a.useState)(""),d=Object(b.a)(u,2),j=d[0],g=d[1],f=e.toggleUpdateRoleModal,x=e.fetchRoles,w=Object(a.useState)("#f44336"),k=Object(b.a)(w,2),S=k[0],N=k[1],M=function(){var t=Object(h.a)(p.a.mark((function t(){var n,a,r,c,o;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,C.a.get("/user/search",{params:{query:j,projectId:e.match.params.projectId,isIn:!0},headers:D()});case 3:for(n=t.sent,a=n.data,r=[],c=a.results,o=0;o<c.length;o++)r.push({key:c[o].id,name:c[o].name,email:c[o].email,id:c[o].id});s(r),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),console.error(I(t.t0));case 14:case"end":return t.stop()}}),t,null,[[0,11]])})));return function(){return t.apply(this,arguments)}}(),A=function(){var t=Object(h.a)(p.a.mark((function t(n){var a,r,s,c,o,l,u;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=n.title,r=[],c=(s=function(e){return!(!e&&void 0!==e)})(n[Tt]),o=s(n[Bt]),l=s(n[Et]),u=s(n[Pt]),c&&o&&l&&u?r.push(Ut):(c&&r.push(Tt),o&&r.push(Bt),l&&r.push(Et),u&&r.push(Pt)),t.prev=8,t.next=11,C.a.put("/role",{roleId:e.role.id,title:a,color:S,permissions:r.join(","),users:i.join(",")},{headers:D()});case 11:f(),x(),se.b.success("Role updated"),t.next=20;break;case 16:t.prev=16,t.t0=t.catch(8),console.error(I(t.t0)),se.b.error(I(t.t0));case 20:case"end":return t.stop()}}),t,null,[[8,16]])})));return function(e){return t.apply(this,arguments)}}(),U=function(t){return"title"===t?e.role.title:"ALL"===e.role.permissions||e.role.permissions.split(",").includes(t)};return console.log(e.role),Object(R.jsx)("div",{children:Object(R.jsx)(ce.a,{title:"Update Role",visible:e.visible,footer:null,destroyOnClose:!0,onCancel:f,children:null!==e.role?Object(R.jsxs)(m.a,{layout:"vertical",onFinish:A,children:[Object(R.jsx)(m.a.Item,{label:"Title",name:"title",initialValue:U("title"),rules:[{required:!0,message:"Please add a title"}],children:Object(R.jsx)(O.a,{type:"text"})}),Object(R.jsx)(m.a.Item,{label:"Members",name:"members",initialValue:i,children:Object(R.jsx)(K.a,{showSearch:!0,mode:"multiple",placeholder:"search...",filterOption:!1,onSearch:function(e){g(e),M()},onChange:l,children:r.map((function(e){return Object(R.jsx)(Rt,{children:"".concat(e.name," (").concat(e.email,")")},e.id)}))})}),Object(R.jsx)(m.a.Item,{label:"Color",name:"color",children:Object(R.jsx)(At.a,{color:S,onChangeComplete:function(e){return N(e.hex)}})}),Object(R.jsx)(m.a.Item,{label:"Can modify bugs",name:Bt,initialValue:U(Bt),valuePropName:"checked",children:Object(R.jsx)(le.a,{})}),Object(R.jsx)(m.a.Item,{label:"Can modify announcements",name:Tt,valuePropName:"checked",initialValue:U(Tt),children:Object(R.jsx)(le.a,{})}),Object(R.jsx)(m.a.Item,{label:"Can modify project",name:Et,valuePropName:"checked",initialValue:U(Et),children:Object(R.jsx)(le.a,{})}),Object(R.jsx)(m.a.Item,{label:"Can modify members",valuePropName:"checked",name:Pt,initialValue:U(Pt),children:Object(R.jsx)(le.a,{})}),Object(R.jsxs)(v.b,{style:{width:"100%",marginTop:20,display:"inline-flex",justifyContent:"flex-end"},children:[Object(R.jsx)(y.a,{onClick:f,children:"Cancel"}),Object(R.jsx)(y.a,{htmlType:"submit",type:"primary",children:"Update"})]})]}):null})})})),Ft="ALL",zt="MODIFY_GENERAL",_t="MODIFY_MEMBERS",Wt="MODIFY_BUGS",Vt="MODIFY_ANNOUNCEMENTS",qt=K.a.Option,Ht=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={roles:[],selectedRole:null,isModalVisible:!1,members:[],selectedMembers:[],search:"",current:"display",updateRoleModalVisible:!1,color:"#f44336"},e._handleUserSearch=Object(h.a)(p.a.mark((function t(){var n,a,r,s,c,o;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.state.search,t.prev=1,t.next=4,C.a.get("/user/search",{params:{query:n,projectId:e.props.match.params.projectId,isIn:!0},headers:D()});case 4:for(a=t.sent,r=a.data,s=[],c=r.results,o=0;o<c.length;o++)s.push({key:c[o].id,name:c[o].name,email:c[o].email,id:c[o].id});e.setState({members:s}),t.next=16;break;case 12:return t.prev=12,t.t0=t.catch(1),N(t.t0),t.abrupt("return");case 16:case"end":return t.stop()}}),t,null,[[1,12]])}))),e._handleSelectUser=function(t){e.setState({selectedMembers:t})},e.createRole=function(){var t=Object(h.a)(p.a.mark((function t(n){var a,r,s,c,o,i,l;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log(n),a=n.title,r=[],c=(s=function(e){return!(!e&&void 0!==e)})(n[Vt]),o=s(n[Wt]),i=s(n[zt]),l=s(n[_t]),c&&o&&i&&l?r.push(Ft):(c&&r.push(Vt),o&&r.push(Wt),i&&r.push(zt),l&&r.push(_t)),t.prev=9,t.next=12,C.a.post("/role",{projectId:e.props.project.id,title:a,permissions:r.join(","),color:e.state.color,users:e.state.selectedMembers.join(",")},{headers:D()});case 12:e.setState({isModalVisible:!1}),se.b.success("Role created"),e.fetchRoles(),t.next=21;break;case 17:t.prev=17,t.t0=t.catch(9),N(t.t0),se.b.error("Error: "+I(t.t0));case 21:case"end":return t.stop()}}),t,null,[[9,17]])})));return function(e){return t.apply(this,arguments)}}(),e.fetchRoles=Object(h.a)(p.a.mark((function t(){var n,a;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,C.a.get("/role/all/"+e.props.project.id,{headers:D()});case 3:n=t.sent,a=n.data.roles,console.log("Roles on fetch: "),console.log(a),e.setState({roles:a}),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),N(t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,10]])}))),e.toggleUpdateRoleModal=function(){e.setState({updateRoleModalVisible:!e.state.updateRoleModalVisible})},e.handleChangeComplete=function(t){e.setState({color:t.hex})},e.deleteRole=function(){var t=Object(h.a)(p.a.mark((function t(n){return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,C.a.delete("/role/"+n,{headers:D()});case 3:e.fetchRoles(),se.b.success("role was deleted"),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),N(t.t0),se.b.error("Error: "+I(t.t0));case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}(),e}return Object(i.a)(n,[{key:"componentDidMount",value:function(){this.fetchRoles()}},{key:"componentDidUpdate",value:function(e){e.project.id!==this.props.project.id&&this.fetchRoles()}},{key:"render",value:function(){var e=this,t=this.props.isMobile;return Object(R.jsxs)(R.Fragment,{children:[Object(R.jsxs)("div",{style:{maxWidth:t?"unset":600},children:[Object(R.jsxs)("div",{style:{display:"inline-flex",justifyContent:"space-between",alignItems:"center",flexDirection:"row",width:"100%",marginBottom:20},children:[Object(R.jsx)("h3",{style:{margin:0},children:"All Roles"}),Object(R.jsx)(y.a,{onClick:function(){return e.setState({isModalVisible:!0})},type:"primary",children:"Create New"})]}),Object(R.jsx)(ge.b,{bordered:!0,dataSource:this.state.roles,renderItem:function(t){return Object(R.jsx)(ge.b.Item,{extra:Object(R.jsxs)(v.b,{children:[Object(R.jsx)(y.a,{onClick:function(n){e.setState({selectedRole:t,updateRoleModalVisible:!0}),n.preventDefault()},children:"Edit"}),Object(R.jsx)(Ye.a,{title:"Are you sure?",onConfirm:function(){return e.deleteRole(t.id)},children:Object(R.jsx)(y.a,{danger:!0,children:"Delete"})})]}),children:Object(R.jsxs)(ke.a,{color:t.color,children:[t.title," "]})},t.id)}})]}),Object(R.jsx)(ce.a,{title:"Create Role",visible:this.state.isModalVisible,onOk:this.createRole,footer:null,destroyOnClose:!0,onCancel:function(){return e.setState({isModalVisible:!1})},children:Object(R.jsxs)(m.a,{layout:"vertical",onFinish:this.createRole,children:[Object(R.jsx)(m.a.Item,{label:"Title",name:"title",rules:[{required:!0,message:"Please add a title"}],children:Object(R.jsx)(O.a,{type:"text"})}),Object(R.jsx)(m.a.Item,{label:"Members",name:"members",children:Object(R.jsx)(K.a,{showSearch:!0,mode:"multiple",placeholder:"search...",filterOption:!1,onSearch:function(t){return e.setState({search:t},e._handleUserSearch)},onChange:this._handleSelectUser,children:this.state.members.map((function(e){return Object(R.jsx)(qt,{children:"".concat(e.name," (").concat(e.email,")")},e.id)}))})}),Object(R.jsx)(m.a.Item,{label:"Color",name:"color",children:Object(R.jsx)(At.a,{color:this.state.color,onChangeComplete:this.handleChangeComplete})}),Object(R.jsx)(m.a.Item,{label:"Can modify bugs",name:Wt,valuePropName:"checked",children:Object(R.jsx)(le.a,{defaultChecked:!0})}),Object(R.jsx)(m.a.Item,{label:"Can modify announcements",name:Vt,valuePropName:"checked",children:Object(R.jsx)(le.a,{defaultChecked:!0})}),Object(R.jsx)(m.a.Item,{label:"Can modify project",name:zt,valuePropName:"checked",children:Object(R.jsx)(le.a,{defaultChecked:!0})}),Object(R.jsx)(m.a.Item,{label:"Can modify members",valuePropName:"checked",name:_t,children:Object(R.jsx)(le.a,{defaultChecked:!0})}),Object(R.jsxs)(v.b,{style:{width:"100%",marginTop:20,display:"inline-flex",justifyContent:"flex-end"},children:[Object(R.jsx)(y.a,{onClick:function(){e.setState({isModalVisible:!1})},children:"Cancel"}),Object(R.jsx)(y.a,{htmlType:"submit",type:"primary",children:"Create"})]})]})}),Object(R.jsx)(Lt,{visible:this.state.updateRoleModalVisible,toggleUpdateRoleModal:this.toggleUpdateRoleModal,role:this.state.selectedRole,fetchRoles:this.fetchRoles})]})}}]),n}(r.a.Component),Yt=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={enableNotifications:!0},e.TOKEN=window.localStorage.getItem("token"),e.getCurrentSetting=Object(h.a)(p.a.mark((function t(){var n,a;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,C.a.get("/notification-setting/"+e.props.project.id,{headers:D()});case 3:n=t.sent,a=n.data,e.setState({enableNotifications:a.notificationSetting.recieveNotifications}),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(0),N(t.t0),se.b.error("Error: "+I(t.t0));case 12:case"end":return t.stop()}}),t,null,[[0,8]])}))),e.setCurrentSetting=function(){var t=Object(h.a)(p.a.mark((function t(n){return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,C.a.put("/notification-setting/"+e.props.project.id,{recieveNotifications:n},{headers:D()});case 3:se.b.success("Setting updated!"),e.setState({enableNotifications:n}),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),N(t.t0),se.b.error("Error: "+I(t.t0));case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}(),e}return Object(i.a)(n,[{key:"componentDidMount",value:function(){this.getCurrentSetting()}},{key:"componentDidUpdate",value:function(e){e.project.id!==this.props.project.id&&this.getCurrentSetting()}},{key:"render",value:function(){var e=this,t=this.props.isMobile;return Object(R.jsx)("div",{style:{width:t?"unset":500},children:Object(R.jsx)(ge.b,{bordered:!0,dataSource:[0],renderItem:function(t){return Object(R.jsx)(ge.b.Item,{extra:Object(R.jsx)(le.a,{onChange:e.setCurrentSetting,checked:e.state.enableNotifications}),children:"Enable notifications for this project?"},t)}})})}}]),n}(r.a.Component),Qt=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"render",value:function(){return"members"}}]),n}(r.a.Component),Xt=["General","Roles","Notifications"],Gt=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={isAuthed:!1,selectedSetting:"general"},a}return Object(i.a)(n,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this;return Object(R.jsx)(S.a,{maxWidth:800,children:function(t){return Object(R.jsxs)("div",{style:{display:"flex",flexDirection:t?"column":"row",marginTop:10,marginRight:t?10:64,gap:20},children:[Object(R.jsx)("style",{children:"\n.bugg-list-item-button:hover {\n    background-color: rgb(0 0 0 / 5%);\n    cursor: pointer;\n}\n.bugg-list-item-button {\n    background-color: white;\n}\n"}),Object(R.jsx)("div",{children:Object(R.jsx)(ge.b,{bordered:!0,dataSource:Xt,style:{width:t?"unset":220},renderItem:function(t){var n=t.toLowerCase().split(" ").join("-");return Object(R.jsxs)(ge.b.Item,{className:"bugg-list-item-button",onClick:function(){e.setState({selectedSetting:n})},style:{color:e.state.selectedSetting===n?"#0094f7":"black"},children:[Object(R.jsx)(xe.a,{style:{marginRight:10},children:t.substring(0,1).toLocaleUpperCase()})," ",t]},n)}})}),Object(R.jsx)("div",{style:{flex:1},children:function(){switch(e.state.selectedSetting){case Xt[0].toLowerCase().split(" ").join("-"):return Object(R.jsx)(Dt,{project:e.props.project,updateProject:e.props.updateProject,updateProjectOnNavigation:e.props.updateProjectOnNavigation});case Xt[1].toLowerCase().split(" ").join("-"):return Object(R.jsx)(Ht,{isMobile:t,project:e.props.project});case Xt[2].toLowerCase().split(" ").join("-"):return Object(R.jsx)(Yt,{isMobile:t,project:e.props.project});case Xt[3].toLowerCase().split(" ").join("-"):return Object(R.jsx)(Qt,{project:e.props.project});default:return"no tab selected"}}()})]})}})}}]),n}(r.a.Component),Jt=n(372),Kt=O.a.Search,Zt=K.a.Option;var $t=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).TOKEN=window.localStorage.getItem("token"),a.fetchMembers=Object(h.a)(p.a.mark((function e(){var t,n,r,s,c,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.state,n=t.page,r=t.pageSize,s=t.search,e.prev=1,e.next=4,C.a.get("/project/users/"+a.props.project.id,{headers:D(),params:{skip:(n-1)*r,limit:r,search:s}});case 4:c=e.sent,o=c.data,a.setState({members:o.members,total:o.total}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),N(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])}))),a.updateSearch=function(e){a.setState({search:e,page:1},a.fetchMembers)},a.onChangePagination=function(e,t){a.setState({page:e,pageSize:t},a.fetchMembers)},a.toggleAddMember=function(){return a.setState({toggleAddMember:!a.state.toggleAddMember})},a.updateMembersToAdd=function(e){return a.setState({selectedMembersToAdd:e})},a.addMembers=Object(h.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.state.selectedMembersToAdd,e.prev=1,e.next=4,C.a.post("/project/member",{userEmails:t,projectId:a.props.project.id},{headers:D()});case 4:se.b.success("users invited!"),a.toggleAddMember(),a.fetchMembers(),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),N(e.t0),se.b.error("Error: "+I(e.t0));case 13:case"end":return e.stop()}}),e,null,[[1,9]])}))),a.searchMembers=Object(h.a)(p.a.mark((function e(){var t,n,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.state.query,e.prev=1,e.next=4,C.a.get("/user/search",{params:{query:t,projectId:a.props.match.params.projectId,isIn:!1},headers:D()});case 4:n=e.sent,r=n.data.results.map((function(e){return{key:e.email,name:e.name,email:e.email,id:e.id,isInServer:!0}})),/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(t).toLowerCase())&&(r=[{isInServer:!1,email:t,key:t}].concat(Object(je.a)(r))),a.setState({membersToAdd:r}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),N(e.t0);case 13:case"end":return e.stop()}}),e,null,[[1,10]])}))),a.removeMember=function(){var e=Object(h.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C.a.delete("/project/member",{headers:D(),data:{projectId:a.props.project.id,userId:t}});case 3:return a.fetchMembers(),a.setState({confirmVisible:!1,deleteButtonLoading:!1}),e.prev=5,e.next=8,pt();case 8:e.sent.id===t&&(a.props.updateProject(),a.props.history.push("/dashboard")),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(5),N(e.t0);case 15:e.next=21;break;case 17:e.prev=17,e.t1=e.catch(0),N(e.t1),se.b.error("Error: "+I(e.t1));case 21:case"end":return e.stop()}}),e,null,[[0,17],[5,12]])})));return function(t){return e.apply(this,arguments)}}(),a.state={toggleAddMember:!1,page:1,pageSize:50,total:0,search:"",members:[],membersToAdd:[],query:"",selectedMembersToAdd:[],confirmVisible:!1,deleteButtonLoading:!1},a}return Object(i.a)(n,[{key:"componentDidMount",value:function(){this.fetchMembers()}},{key:"componentDidUpdate",value:function(e){e.project.id!==this.props.project.id&&this.fetchMembers()}},{key:"render",value:function(){var e=this,t=this.props.isMobile;return Object(R.jsxs)("div",{style:{marginRight:t?10:64},children:[Object(R.jsxs)("div",{style:{marginBottom:20,gap:6,display:"flex",flexWrap:"wrap"},children:[Object(R.jsx)(Kt,{style:{width:200},placeholder:"search",value:this.state.search,onChange:function(t){return e.updateSearch(t.target.value)},onSearch:this.updateSearch}),Object(R.jsx)(y.a,{onClick:this.toggleAddMember,type:"primary",children:"Add New Member"})]}),Object(R.jsx)(ge.b,{pagination:{current:this.state.page,total:this.state.total,pageSize:this.state.pageSize,onChange:this.onChangePagination},bordered:!0,dataSource:this.state.members,style:{maxWidth:900},renderItem:function(n){return Object(R.jsxs)(ge.b.Item,{actions:[!n.isOwner&&Object(R.jsx)(Ye.a,{title:"Are you sure?",okButtonProps:{loading:e.state.deleteButtonLoading},onConfirm:function(){return e.removeMember(n.id)},children:Object(R.jsx)(y.a,Object(Q.a)(Object(Q.a)({},t?{icon:Object(R.jsx)(Jt.a,{})}:{}),{},{danger:!0,children:t?"":"Remove"}))})],children:[Object(R.jsx)(xe.a,{style:{marginRight:10},children:n.name.substring(0,1)}),"".concat(n.name.split(" ")[0]," ").concat(n.name.split(" ")[1]?n.name.split(" ")[1].substring(0,1).toUpperCase()+".":""," (").concat(n.email,")"),n.isOwner&&Object(R.jsx)(ke.a,{color:"red",style:{marginLeft:10},children:"OWNER"})]},n.id)}}),Object(R.jsx)(ce.a,{title:"Add More Members...",visible:this.state.toggleAddMember,destroyOnClose:!0,onOk:this.addMembers,onCancel:this.toggleAddMember,children:Object(R.jsx)(K.a,{mode:"multiple",allowClear:!0,style:{width:"100%"},placeholder:"Start typing...",onSearch:function(t){e.setState({query:t},e.searchMembers)},onChange:this.updateMembersToAdd,children:this.state.membersToAdd.map((function(e){return e.isInServer?Object(R.jsx)(Zt,{children:"".concat(e.name," (").concat(e.email,")")},e.key):Object(R.jsx)(Zt,{children:"Invite person with email '".concat(e.email,"'")},e.key)}))})})]})}}]),n}(r.a.Component),en=Object(j.h)($t),tn=n(668),nn=n(669),an=n(670),rn=n(671),sn=n(672),cn=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;Object(o.a)(this,n),(a=t.call(this,e)).getUriAction=function(e){var t;return null!==(t={OPEN_BUG:function(){return a.setState({activeTab:"bugs"})},OPEN_ANNOUNCEMENT:function(){return a.setState({activeTab:"announcements"})}}[e])&&void 0!==t?t:function(){return null}},a.updateProject=function(){var e=Object(h.a)(p.a.mark((function e(t){var n,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return window.localStorage.getItem("token"),t=t||a.state.project.id,e.prev=2,e.next=5,C.a.get("/project/find",{headers:D(),params:{projectId:t}});case 5:n=e.sent,(r=n.data).project&&a.setState({title:r.project.title,project:r.project,imageUrl:M+"/icon/"+(r.project.icon&&r.project.icon[0]?r.project.icon[0].id:"")}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),N(e.t0);case 13:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t){return e.apply(this,arguments)}}(),a.handleClick=function(e){return a.setState({activeTab:e.key})},a.getImageSize=function(e){return e?70:a.state.project.description?107:72};var r=a.props.location.pathname.split("/");return r=r[r.length-1],a.state={activeTab:"overview",title:"",imageUrl:"",project:{id:r}},a}return Object(i.a)(n,[{key:"componentDidMount",value:function(){var e=this.props.location.pathname.split("/");e=e[e.length-1],this.updateProject(e);var t=this.props.location,n=new URLSearchParams(t.search);n.has("action")&&this.getUriAction(n.get("action"))()}},{key:"componentDidUpdate",value:function(e){if(this.props.location!==e.location){var t=this.props.location.pathname.split("/");t=t[t.length-1],this.updateProject(t);var n=this.props.location,a=new URLSearchParams(n.search);a.has("action")&&this.getUriAction(a.get("action"))()}}},{key:"render",value:function(){var e=this,t=this.state.activeTab;return Object(R.jsx)(S.a,{maxWidth:800,children:function(n){var a;return Object(R.jsxs)(r.a.Fragment,{children:[Object(R.jsx)("style",{children:"\n                        .bugg-skeleton-project-icon {\n                            transition: .3s\n                        }\n                        "}),Object(R.jsxs)(v.b,{align:"center",children:[Object(R.jsx)("div",{className:"bugg-skeleton-project-icon",style:{width:e.getImageSize(n),height:e.getImageSize(n),borderRadius:5,borderColor:"rgba(0,0,0,.2)",borderStyle:"solid",borderWidth:1,backgroundRepeat:"no-repeat",backgroundImage:"url("+e.state.imageUrl+")",backgroundPosition:"center",backgroundSize:"cover",backgroundColor:"rgba(0 0 0 / 5%)",marginRight:10}}),Object(R.jsxs)("div",{children:[Object(R.jsx)("h1",{style:{fontSize:n?26:50,margin:0},children:e.state.title}),Object(R.jsx)("p",{style:{margin:0,opacity:.7,marginLeft:3},children:null!==(a=e.state.project.description)&&void 0!==a?a:""})]})]}),Object(R.jsx)("div",{style:{display:"flex",marginRight:n?10:64,flexDirection:"column"},children:Object(R.jsxs)(oe.a,{overflowedIndicator:"More",style:{marginBottom:20,marginTop:20,position:"relative",width:"99%"},onClick:e.handleClick,selectedKeys:[t],mode:"horizontal",children:[Object(R.jsx)(oe.a.Item,{icon:Object(R.jsx)(tn.a,{}),children:"Overview"},"overview"),Object(R.jsx)(oe.a.Item,{icon:Object(R.jsx)(nn.a,{}),children:"Bugs"},"bugs"),Object(R.jsx)(oe.a.Item,{icon:Object(R.jsx)(an.a,{}),children:"Announcements"},"announcements"),Object(R.jsx)(oe.a.Item,{icon:Object(R.jsx)(de.a,{}),children:"Calendar"},"calendar"),Object(R.jsx)(oe.a.Item,{icon:Object(R.jsx)(rn.a,{}),children:"Settings"},"settings"),Object(R.jsx)(oe.a.Item,{icon:Object(R.jsx)(sn.a,{}),children:"Collaborators"},"collaborators")]})}),function(){switch(e.state.activeTab){case"overview":return Object(R.jsx)(H,{project:e.state.project});case"bugs":return Object(R.jsx)(ft,{project:e.state.project});case"announcements":return Object(R.jsx)(It,{project:e.state.project});case"calendar":return Object(R.jsx)(Mt,{project:e.state.project});case"settings":return Object(R.jsx)(Gt,{project:e.state.project,updateProject:function(){e.updateProject(),e.props.updateProjects()},updateProjectOnNavigation:e.props.updateProjects});case"collaborators":return Object(R.jsx)(en,{isMobile:n,updateProject:e.props.updateProjects,project:e.state.project});default:return"hi"}}()]})}})}}]),n}(r.a.Component),on=Object(j.h)(cn),ln=K.a.Option,un=new FormData;function dn(e){var t=Object(a.useState)([]),n=Object(b.a)(t,2),r=n[0],s=n[1],c=m.a.useForm(),o=Object(b.a)(c,1)[0],i=Object(a.useState)(""),l=Object(b.a)(i,2),u=l[0],d=l[1],j=function(){var e=Object(h.a)(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return un.get("icon")&&un.delete("icon"),un.append("icon",t),(n=new FileReader).addEventListener("load",(function(){d(n.result)}),!1),n.readAsDataURL(t),e.abrupt("return",!1);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),g=function(){var t=Object(h.a)(p.a.mark((function t(n){var a;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log(r),t.prev=1,t.next=4,C.a.post("/project/create",{title:n.title,description:n.description,members:r.join()},{headers:D()});case 4:if(a=t.sent,!un.get("icon")){t.next=8;break}return t.next=8,C.a.post("/icon/upload",un,{headers:Object(Q.a)(Object(Q.a)({},D()),{},{"Content-Type":"multipart/form-data"}),params:{projectId:a.data.id}});case 8:t.next=14;break;case 10:t.prev=10,t.t0=t.catch(1),console.error(I(t.t0)),x.a.error({message:I(t.t0)});case 14:a&&(console.log(a.data),x.a.success({message:"project was created"}),o.resetFields(),e.updateProjects(),d(""),e.closeFunc());case 15:case"end":return t.stop()}}),t,null,[[1,10]])})));return function(e){return t.apply(this,arguments)}}(),f=Object(a.useState)([]),w=Object(b.a)(f,2),k=w[0],S=w[1],N=Object(a.useState)(),M=Object(b.a)(N,2),A=M[0],U=M[1];Object(a.useEffect)((function(){(function(){var e=Object(h.a)(p.a.mark((function e(){var t,n,a,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C.a.get("/user/search",{params:{query:A},headers:D()});case 3:t=e.sent,e.next=10;break;case 6:return e.prev=6,e.t0=e.catch(0),console.error(I(e.t0)),e.abrupt("return");case 10:for(n=[],a=t.data.results,r=0;r<a.length;r++)n.push({key:a[r].id,name:a[r].name,email:a[r].email,id:a[r].id});S(n);case 14:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}})()()}),[A]);return Object(R.jsx)("div",{children:Object(R.jsx)(v.b,{direction:"vertical",style:{width:"100%"},children:Object(R.jsxs)(m.a,{layout:"vertical",onFinish:g,form:o,children:[Object(R.jsx)(m.a.Item,{label:"Title",name:"title",rules:[{required:!0,message:"Please add a title"}],children:Object(R.jsx)(O.a,{type:"text"})}),Object(R.jsx)(m.a.Item,{label:"Description",name:"description",children:Object(R.jsx)(O.a,{type:"text"})}),Object(R.jsx)(m.a.Item,{label:"Icon",name:"icon",children:Object(R.jsx)(Z.a,{name:"avatar",listType:"picture-card",accept:"image/*",showUploadList:!1,beforeUpload:j,children:""===u?"Upload Icon":Object(R.jsx)("div",{style:{width:"80%",height:"80%",backgroundImage:"url("+u+")",backgroundSize:"cover",backgroundPosition:"center"}})})}),Object(R.jsx)(m.a.Item,{label:"Members",name:"members",children:Object(R.jsx)(K.a,{showSearch:!0,mode:"multiple",placeholder:"search...",filterOption:!1,onSearch:U,onChange:function(e,t){s(e)},children:k.map((function(e){return Object(R.jsx)(ln,{children:"".concat(e.name," (").concat(e.email,")")},e.id)}))})}),Object(R.jsxs)(v.b,{style:{width:"100%",marginTop:20,display:"inline-flex",justifyContent:"flex-end"},children:[Object(R.jsx)(y.a,{onClick:function(){o.resetFields(),e.closeFunc(),d("")},children:"Cancel"}),Object(R.jsx)(y.a,{htmlType:"submit",type:"primary",children:"Create"})]})]})})})}var pn=function(e){var t=Object(a.useState)(""),n=Object(b.a)(t,2),r=n[0],s=n[1],c=function(){var t=Object(h.a)(p.a.mark((function t(){var n;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,C.a.post("/project/join",{projectId:r},{headers:D()});case 3:n=t.sent,t.next=11;break;case 6:return t.prev=6,t.t0=t.catch(0),console.error(I(t.t0)),x.a.error({message:I(t.t0)}),t.abrupt("return");case 11:x.a.success({message:"You have joined project "+n.data.project.title+"!"}),e.updateProjects(),s(""),e.closeFunc();case 15:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(){return t.apply(this,arguments)}}();return Object(R.jsxs)("div",{children:[Object(R.jsx)(O.a,{value:r,onChange:function(e){return s(e.target.value)},placeholder:"Type project ID here..."}),Object(R.jsxs)(v.b,{style:{width:"100%",marginTop:20,display:"inline-flex",justifyContent:"flex-end"},children:[Object(R.jsx)(y.a,{onClick:function(){s(""),e.closeFunc()},children:"Cancel"}),Object(R.jsx)(y.a,{onClick:c,type:"primary",children:"Join"})]})]})};var hn=function(e){return Object(R.jsx)(v.b,{style:{width:"100%",borderRadius:5},direction:"vertical",onClick:e.onClick,align:"center",children:Object(R.jsxs)("div",{className:"bugg-button",style:{width:120,borderRadius:5,paddingTop:5},children:[Object(R.jsx)("div",{style:{width:100,height:100,borderRadius:5,borderColor:"rgba(0,0,0,.2)",borderStyle:"solid",backgroundRepeat:"no-repeat",borderWidth:1,backgroundImage:"url("+e.imageUrl+")",backgroundPosition:"center",backgroundSize:"cover",backgroundColor:"rgba(0 0 0 / 5%)",marginLeft:"auto",marginRight:"auto"}}),Object(R.jsx)("h4",{style:{maxWidth:120,textAlign:"center"},children:e.title})]})})},bn=Object(j.h)((function(e){var t,n=Object(a.useState)(!1),r=Object(b.a)(n,2),s=r[0],c=r[1],o=Object(a.useState)(!1),i=Object(b.a)(o,2),l=i[0],u=i[1],d=null!==(t=e.projects)&&void 0!==t?t:[],p=Object(j.g)(),h=Object(k.useMediaQuery)({maxWidth:800});return Object(a.useEffect)(e.updateProjects,[]),Object(R.jsxs)("div",{style:{marginRight:h?10:64,display:"flex",flexDirection:"column"},children:[Object(R.jsxs)("div",{children:[Object(R.jsx)("h1",{children:"Home"}),Object(R.jsx)(me.a,{})]}),Object(R.jsx)(ce.a,{title:"Create Project",footer:null,onCancel:function(){return c(!1)},visible:s,children:Object(R.jsx)(dn,{updateProjects:e.updateProjects,closeFunc:function(){return c(!1)}})}),Object(R.jsx)(ce.a,{title:"Join Project",footer:null,onCancel:function(){return u(!1)},visible:l,children:Object(R.jsx)(pn,{updateProjects:e.updateProjects,closeFunc:function(){return u(!1)}})}),Object(R.jsx)("style",{children:"\n.bugg-button:hover {\n    background-color: rgba(0 0 0 / 10%);\n    cursor: pointer;\n}\n\n.bugg-button {\n    transition: 0.5s;\n}\n"}),Object(R.jsx)(W.a,{gutter:16,children:Object(R.jsx)(V.a,{span:24,children:Object(R.jsx)(g.a,{bodyStyle:{paddingLeft:40,paddingRight:40},extra:Object(R.jsxs)(v.b,{children:[Object(R.jsx)(y.a,{type:"primary",onClick:function(){return c(!0)},children:"Create"}),Object(R.jsx)(y.a,{onClick:function(){return u(!0)},children:"Join"})]}),title:"Projects",children:Object(R.jsx)(W.a,{gutter:[40,40],children:d.map((function(e){return Object(R.jsx)(V.a,{xs:12,md:6,xl:3,children:Object(R.jsx)(hn,{title:e.title,onClick:function(){return p.push("/dashboard/projects/"+e.id)},imageUrl:e.icon.id?M+"/icon/"+e.icon.id:""})})}))})})})})]})})),jn=["General"],gn=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={selectedSetting:jn[0].toLowerCase(),user:{name:"",email:"",id:""},name:"",email:"",loading:!1,password:"",newPassword:"",updatePasswordVisible:!1,loadingUpdatePassword:!1,previewImageUri:""},e.beforeUpload=function(){var t=Object(h.a)(p.a.mark((function t(n){var a;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(a=new FormData).append("icon",n),t.prev=2,t.next=5,ht.User.uploadUserIcon(a);case 5:e.fetchUser(),e.props.getWelcomeMessage(),se.b.success("Icon updated"),t.next=14;break;case 10:t.prev=10,t.t0=t.catch(2),N(t.t0),se.b.error(I(t.t0));case 14:return t.abrupt("return",!1);case 15:case"end":return t.stop()}}),t,null,[[2,10]])})));return function(e){return t.apply(this,arguments)}}(),e.updateIcon=Object(h.a)(p.a.mark((function t(){var n;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,ht.User.getUserIconUri();case 3:n=t.sent,e.setState({previewImageUri:n}),t.next=9;break;case 7:t.prev=7,t.t0=t.catch(0);case 9:case"end":return t.stop()}}),t,null,[[0,7]])}))),e.fetchUser=Object(h.a)(p.a.mark((function t(){var n;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,pt();case 3:n=t.sent,e.updateIcon(),e.setState({user:n,name:n.name,email:n.email}),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),N(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])}))),e.updateUser=function(){var t=Object(h.a)(p.a.mark((function t(n,a){var r;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({loading:!0}),t.prev=1,t.next=4,ht.User.updateUser(n,a);case 4:r=t.sent,e.setState({user:r,name:r.name,email:r.email}),e.props.getWelcomeMessage(),se.b.success("user updated"),t.next=14;break;case 10:t.prev=10,t.t0=t.catch(1),e.setState(Object(Y.a)({},n,e.state.user[n])),se.b.error("Error: "+I(t.t0));case 14:e.setState({loading:!1});case 15:case"end":return t.stop()}}),t,null,[[1,10]])})));return function(e,n){return t.apply(this,arguments)}}(),e.updatePassword=Object(h.a)(p.a.mark((function t(){var n,a,r,s;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.state,a=n.password,r=n.newPassword,a&&r){t.next=4;break}return se.b.error("Please input current and new password"),t.abrupt("return");case 4:return e.setState({loadingUpdatePassword:!0}),t.prev=5,t.next=8,ht.User.updatePassword(a,r);case 8:s=t.sent,se.b.success("Password updated"),e.setState({updatePasswordVisible:!1}),window.localStorage.setItem("token",s),B(),e.fetchUser(),t.next=19;break;case 16:t.prev=16,t.t0=t.catch(5),se.b.error(I(t.t0));case 19:e.setState({loadingUpdatePassword:!1});case 20:case"end":return t.stop()}}),t,null,[[5,16]])}))),e}return Object(i.a)(n,[{key:"componentDidMount",value:function(){this.fetchUser()}},{key:"render",value:function(){var e=this,t=[{title:"Name",reactNode:Object(R.jsxs)(v.b,{children:[Object(R.jsx)(O.a,{value:this.state.name,onPressEnter:function(){e.state.name!==e.state.user.name&&e.updateUser("name",e.state.name)},onChange:function(t){e.setState({name:t.target.value})},type:"text"}),Object(R.jsx)(y.a,{loading:this.state.loading,onClick:function(){return e.updateUser("name",e.state.name)},type:"primary",disabled:this.state.name===this.state.user.name,children:"Update"})]})},{title:"Email",reactNode:Object(R.jsxs)(v.b,{children:[Object(R.jsx)(O.a,{value:this.state.email,onPressEnter:function(){e.state.email!==e.state.user.email&&e.updateUser("email",e.state.email)},onChange:function(t){e.setState({email:t.target.value})},type:"text"}),Object(R.jsx)(y.a,{loading:this.state.loading,onClick:function(){return e.updateUser("email",e.state.email)},type:"primary",disabled:this.state.email===this.state.user.email,children:"Update"})]})},{title:"Password",reactNode:Object(R.jsx)(y.a,{onClick:function(){return e.setState({updatePasswordVisible:!0})},type:"primary",children:"Update"})},{title:"User Icon",reactNode:Object(R.jsx)("div",{children:Object(R.jsx)(Z.a,{name:"avatar",listType:"picture-card",accept:"image/*",showUploadList:!1,beforeUpload:this.beforeUpload,children:this.state.previewImageUri?Object(R.jsx)("div",{style:{width:"80%",height:"80%",backgroundImage:"url("+this.state.previewImageUri+")",backgroundSize:"cover",backgroundPosition:"center"}}):"Upload Icon"})})}];return Object(R.jsx)(S.a,{maxWidth:800,children:function(n){return Object(R.jsxs)("div",{style:{marginRight:n?10:64},children:[Object(R.jsx)("style",{children:"\n.bugg-list-item-button:hover {\n    background-color: rgb(0 0 0 / 5%);\n    cursor: pointer;\n}\n.bugg-list-item-button {\n    background-color: white;\n}\n"}),Object(R.jsx)("h1",{children:"Settings"}),Object(R.jsx)(me.a,{}),Object(R.jsxs)("div",{style:{display:n?"flex":"inline-flex",width:"100%",flexDirection:n?"column":"unset"},children:[Object(R.jsx)("div",{children:Object(R.jsx)(ge.b,{bordered:!0,dataSource:jn,style:{width:n?"unset":200,marginBottom:n?20:"unset"},renderItem:function(t,n){return Object(R.jsxs)(ge.b.Item,{style:{color:e.state.selectedSetting===t.toLowerCase()?"#0094f7":"black"},className:"bugg-list-item-button",children:[Object(R.jsx)(xe.a,{style:{marginRight:10},children:t.substring(0,1).toLocaleUpperCase()})," ",t]},n)}})}),Object(R.jsx)("div",{style:{flex:1,marginLeft:n?0:20},children:function(){switch(e.state.selectedSetting){case jn[0].toLowerCase():return Object(R.jsx)(ge.b,{bordered:!0,style:{},itemLayout:"vertical",dataSource:t,renderItem:function(e){return Object(R.jsx)(ge.b.Item,{extra:[e.reactNode],children:e.title},e.title)}});default:return"no tab selected"}}()}),Object(R.jsxs)(ce.a,{okButtonProps:{loading:e.state.loadingUpdatePassword},destroyOnClose:!0,visible:e.state.updatePasswordVisible,title:"Update Password",onOk:e.updatePassword,onCancel:function(){return e.setState({updatePasswordVisible:!1})},children:[Object(R.jsx)("p",{style:{marginBottom:10},children:"Current Password: "}),Object(R.jsx)(O.a,{type:"password",autoComplete:"new-password",name:"new-password",value:e.state.password,onChange:function(t){return e.setState({password:t.target.value})},placeholder:"Type here..."}),Object(R.jsx)("p",{style:{marginBottom:10,marginTop:20},children:"New Password: "}),Object(R.jsx)(O.a,{type:"password",autoComplete:"new-password",value:e.state.newPassword,onChange:function(t){return e.setState({newPassword:t.target.value})},placeholder:"Type here..."})]})]})]})}})}}]),n}(r.a.Component),fn=n(673),mn=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={page:1,pageSize:10,notifications:[],total:1,isListening:!1},e.getAction=function(t){switch(t.type){case"PROJECT_INVITE":e.props.joinProject(t.payload.projectId);break;case"NEW_MESSAGE":e.props.openNewMessage(t.payload.conversationId),e.props.close();break;case"NEW_BUG":e.props.history.push("/dashboard/projects/"+t.payload.projectId+"?action=OPEN_BUG&bugId=".concat(t.payload.bugId)),e.props.close();break;case"NEW_ANNOUNCEMENT":e.props.history.push("/dashboard/projects/"+t.payload.projectId+"?action=OPEN_ANNOUNCEMENT&announcementId=".concat(t.payload.announcementId)),e.props.close();break;default:se.b.error("no type given")}e.dismissNotification(t.id)},e.dismissNotification=function(){var t=Object(h.a)(p.a.mark((function t(n){return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,C.a.delete("/notification/"+n,{headers:D()});case 3:e.fetchNotifications(),se.b.success("Notification Dismissed"),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),N(t.t0),se.b.error("Error: "+I(t.t0));case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}(),e.dismissAllNotifications=Object(h.a)(p.a.mark((function t(){return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,C.a.delete("/notification/all",{headers:D()});case 3:e.fetchNotifications(),se.b.success("All notifications were dismissed"),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),N(t.t0),se.b.error("Error: "+I(t.t0));case 11:case"end":return t.stop()}}),t,null,[[0,7]])}))),e.onRecieveNotitification=function(t){e.setState({page:1},e.fetchNotifications)},e.fetchNotifications=Object(h.a)(p.a.mark((function t(){var n,a,r,s,c;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.state,a=n.page,r=n.pageSize,t.prev=1,t.next=4,C.a.get("/notification/all",{headers:D(),params:{limit:r,skip:(a-1)*r}});case 4:s=t.sent,c=s.data,console.log(c),e.setState({notifications:c.notifications,total:c.totalNotifications}),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(1),N(t.t0);case 13:case"end":return t.stop()}}),t,null,[[1,10]])}))),e.updatePagination=function(t,n){e.setState({page:t,pageSize:n},e.fetchNotifications)},e.getNotificationActionMessage=function(e){var t;return null!==(t={PROJECT_INVITE:"Join Project",NEW_MESSAGE:"View Message"}[e])&&void 0!==t?t:"View"},e}return Object(i.a)(n,[{key:"componentDidMount",value:function(){E("new-notification",this.onRecieveNotitification),this.fetchNotifications()}},{key:"componentWillUnmount",value:function(){P("new-notification",this.onRecieveNotitification)}},{key:"render",value:function(){var e=this;return Object(R.jsxs)("div",{children:[Object(R.jsx)(v.b,{style:{marginBottom:20},children:Object(R.jsx)(y.a,{onClick:this.dismissAllNotifications,type:"primary",children:"Dismiss All"})}),Object(R.jsx)(ge.b,{pagination:{pageSize:this.state.pageSize,page:this.state.page,onChange:this.updatePagination,total:this.state.total},dataSource:this.state.notifications,renderItem:function(t){return Object(R.jsx)("div",{style:{marginBottom:20},children:Object(R.jsx)(g.a,{actions:[Object(R.jsx)(y.a,{onClick:function(){return e.getAction(t)},type:"primary",children:e.getNotificationActionMessage(t.type)}),Object(R.jsx)(y.a,{onClick:function(){return e.dismissNotification(t.id)},type:"link",children:"Dismiss"})],children:Object(R.jsx)(g.a.Meta,{avatar:Object(R.jsx)(xe.a,{icon:Object(R.jsx)(fn.a,{})}),title:Object(R.jsxs)(R.Fragment,{children:[t.title,t.read?null:Object(R.jsx)(ke.a,{color:"red",style:{marginLeft:10},children:"New"})]}),description:t.description+" - "+ve()(new Date(t.createdAt)).fromNow()})})},t.id)}})]})}}]),n}(r.a.Component),xn=Object(j.h)(mn),On=n(674);var vn=function(e){var t=e.toggleCollapse,n=e.toggleHide,a=e.sendMessage,r=e.conversations,s=e.selectConversation,c=e.activeConversations,o=e.isMobile,i=function(e){var t=e.split(" "),n=t[0];return t[1]&&(n+=" "+t[1].substring(0,1).toUpperCase()+"."),n};return Object(R.jsxs)(g.a,{headStyle:{backgroundColor:"#2f2f2f",color:"white"},title:"Contacts",extra:Object(R.jsx)(v.b,{size:"middle",children:Object(R.jsx)(y.a,{onClick:t,type:"text",icon:Object(R.jsx)(On.a,{style:{color:"white"}})})}),style:{width:350,borderColor:"rgba(0,0,0,.3)",padding:0,overflow:"hidden",display:o?c.length>0||n?"none":"block":n?"none":"block"},id:"contacts-card",bodyStyle:{padding:0,height:300,display:"flex",flexDirection:"column"},children:[Object(R.jsx)(v.b,{style:{width:"100%",marginTop:20,marginBottom:20},children:Object(R.jsx)(y.a,{style:{marginLeft:20},onClick:a,type:"primary",children:"Send New Message"})}),Object(R.jsx)("div",{style:{flex:1,overflowY:"auto"},children:Object(R.jsx)(ge.b,{dataSource:r,renderItem:function(e){return Object(R.jsx)(ge.b.Item,{style:{paddingLeft:20,paddingRight:20},extra:[ve()(new Date(e.updatedAt).getTime()).fromNow()],children:Object(R.jsx)(ge.b.Item.Meta,{title:Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)("a",{href:"#",onClick:function(t){return s(t,e)},children:i(e.reciepent.name)}),(t=e,!c.map((function(e){return e.id})).includes(t.id)&&t.newMessages?Object(R.jsx)(ke.a,{style:{marginLeft:10},color:"red",children:"New"}):null)]}),avatar:Object(R.jsx)(xe.a,{style:{marginRight:10},children:e.reciepent.name.substring(0,1).toUpperCase()}),description:e.lastMessageText})},e.id);var t}})})]})},yn=n(70),wn=n(675),Cn=n(49),kn=n(69);function Sn(e){return e.recipient?Object(R.jsxs)("div",{style:{display:"inline-flex",width:"100%"},children:[Object(R.jsx)(xe.a,{style:{marginLeft:7},children:e.avatarLetter}),Object(R.jsx)("p",{style:{maxWidth:200,backgroundColor:"rgb(0 0 0 / 20%)",padding:5,borderRadius:4,marginLeft:10},children:e.message})]}):e.sender?Object(R.jsxs)("div",{style:{display:"inline-flex",justifyContent:"flex-end",width:"100%"},children:[Object(R.jsx)("p",{style:{maxWidth:200,backgroundColor:"rgb(24 144 255 / 30%)",padding:5,borderRadius:4,marginRight:10},children:e.message}),Object(R.jsx)(xe.a,{style:{marginRight:7},children:e.avatarLetter})]}):null}var In=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={messages:[],body:"",toggledState:!1,listening:!1,newMessages:!1},e.TOKEN=window.localStorage.getItem("token"),e.fetchMessages=Object(h.a)(p.a.mark((function t(){var n,a;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,C.a.get("/conversation/"+e.props.conversation.id,{headers:D(),params:{limit:20,skip:0}});case 3:n=t.sent,a=n.data,e.setState({messages:a.messages.reverse(),total:a.total}),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.error(I(t.t0));case 11:case"end":return t.stop()}}),t,null,[[0,8]])}))),e.sendMessage=Object(h.a)(p.a.mark((function t(){var n,a,r;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(""!==e.state.body.replace(/ /g,"")){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,C.a.post("/message/"+e.props.conversation.recipient.id,{body:e.state.body},{headers:D()});case 5:n=t.sent,a=n.data,(r=e.state.messages).push(a.message),e.setState({messages:r,body:""}),e.props.fetchConversations(),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(2),console.error(I(t.t0));case 16:case"end":return t.stop()}}),t,null,[[2,13]])}))),e.toggleCollapse=function(){var t=!e.state.toggledState;e.setState({toggledState:t});var n=document.getElementById(e.props.conversation.id);t?Object(Cn.a)({targets:[n],height:64,easing:"easeInOutQuad",duration:300}):(e.setState({newMessages:!1}),Object(Cn.a)({targets:[n],height:364,easing:"easeInOutQuad",duration:300}))},e.onRecieveNewMessage=function(t){var n=e.state.messages;n.push(t),e.setState({messages:n}),e.state.toggledState&&e.setState({newMessages:!0}),e.props.fetchConversations()},e.readAllMessages=Object(h.a)(p.a.mark((function t(){return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,ht.Message.readAllMessages(e.props.conversation.id);case 3:e.props.fetchUnreadNotifications(),t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),N(t.t0);case 9:case"end":return t.stop()}}),t,null,[[0,6]])}))),e}return Object(i.a)(n,[{key:"componentDidMount",value:function(){var e=Object(h.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetchMessages();case 2:this.props.fetchUnreadNotifications(),E("new-message",this.onRecieveNewMessage),this.props.fetchConversations();case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){P("new-message",this.onRecieveNewMessage)}},{key:"render",value:function(){var e=this,t=this.props,n=t.removeConversation,a=t.conversation;return Object(R.jsx)(g.a,{headStyle:{backgroundColor:"#2f2f2f",color:"white"},id:a.id,title:Object(R.jsxs)(R.Fragment,{children:[" ",a.reciepent.name," ",this.state.newMessages?Object(R.jsx)(ke.a,{style:{marginLeft:10},color:"red",children:"New Message"}):null," "]}),extra:Object(R.jsxs)(v.b,{size:"middle",children:[Object(R.jsx)(y.a,{onClick:this.toggleCollapse,type:"text",icon:Object(R.jsx)(On.a,{style:{color:"white"}})}),Object(R.jsx)(y.a,{type:"text",onClick:Object(h.a)(p.a.mark((function t(){return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.readAllMessages();case 2:n(a.id);case 3:case"end":return t.stop()}}),t)}))),icon:Object(R.jsx)(kn.a,{style:{color:"white"}})})]}),style:{width:350,borderColor:"rgba(0,0,0,.3)",padding:0,overflow:"hidden",display:this.props.toggleHide?"none":"block"},bodyStyle:{padding:0,height:300},children:Object(R.jsxs)("div",{style:{display:"flex",flexDirection:"column",height:"100%"},children:[Object(R.jsx)("div",{style:{display:"flex",flex:1,flexDirection:"column-reverse",overflowY:"auto"},direction:"vertical",children:Object(R.jsx)(ge.b,{dataSource:this.state.messages,renderItem:function(e,t){return Object(R.jsx)("div",{children:Object(R.jsx)(Sn,{sender:e.sender.isYou,recipient:!e.sender.isYou,timestamp:e.createdAt,avatarLetter:e.sender.name.substring(0,1).toUpperCase(),message:e.body})},e.id)}})}),Object(R.jsxs)("div",{style:{width:"100%",padding:6,display:"inline-flex"},children:[Object(R.jsx)(O.a,{style:{flex:1,marginRight:10},placeholder:"Start Typing...",value:this.state.body,onChange:function(t){return e.setState({body:t.target.value})},onPressEnter:this.sendMessage}),Object(R.jsx)(y.a,{onClick:this.sendMessage,type:"primary",children:"Send"})]})]})})}}]),n}(r.a.Component),Nn=K.a.Option,Mn=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={members:[],selectedMember:"",query:"",body:""},e.TOKEN=window.localStorage.getItem("token"),e.searchUsers=Object(h.a)(p.a.mark((function t(){var n,a,r,s,c;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.state.query,t.prev=1,t.next=4,C.a.get("/user/search",{params:{query:a},headers:D()});case 4:n=t.sent,t.next=11;break;case 7:return t.prev=7,t.t0=t.catch(1),console.error(I(t.t0)),t.abrupt("return");case 11:for(r=[],s=n.data.results,c=0;c<s.length;c++)r.push({key:s[c].id,name:s[c].name,email:s[c].email,id:s[c].id});e.setState({members:r});case 15:case"end":return t.stop()}}),t,null,[[1,7]])}))),e.selectUser=function(t){e.setState({selectedMember:t})},e.sendMessage=Object(h.a)(p.a.mark((function t(){var n,a;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(""!==e.state.body.replace(/ /g,"")){t.next=3;break}return se.b.error("Please enter message"),t.abrupt("return");case 3:if(e.state.selectedMember){t.next=7;break}return se.b.error("Please select a recipient"),t.abrupt("return");case 7:return t.prev=7,t.next=10,C.a.post("/message/"+e.state.selectedMember,{body:e.state.body},{headers:D()});case 10:return n=t.sent,a=n.data,e.setState({body:""}),console.log(a.message.conversation),t.next=16,e.props.fetchConversations();case 16:e.props.selectConversation(a.message.conversation),e.props.closeModal(),t.next=23;break;case 20:t.prev=20,t.t0=t.catch(7),console.error(I(t.t0));case 23:case"end":return t.stop()}}),t,null,[[7,20]])}))),e}return Object(i.a)(n,[{key:"render",value:function(){var e=this;return Object(R.jsxs)(ce.a,{visible:this.props.visible,title:"Send New Message",onCancel:this.props.closeModal,onOk:this.sendMessage,destroyOnClose:!0,children:[Object(R.jsx)("p",{children:"Send To:"}),Object(R.jsx)(K.a,{showSearch:!0,placeholder:"search...",style:{width:"100%"},filterOption:!1,onSearch:function(t){e.setState({query:t},e.searchUsers)},onChange:this.selectUser,children:this.state.members.map((function(e){return Object(R.jsx)(Nn,{children:"".concat(e.name," (").concat(e.email,")")},e.id)}))}),Object(R.jsx)("br",{}),Object(R.jsx)("p",{style:{marginTop:20},children:"Message:"}),Object(R.jsx)(O.a,{onChange:function(t){return e.setState({body:t.target.value})},value:this.state.body,onPressEnter:this.sendMessage,placeholder:"Start typing..."})]})}}]),n}(r.a.Component),Dn=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).toggleHideSimple=function(e){var t=!a.state.toggleHide;a.setState({toggleHide:t}),t||!0===e||a.fetchConversations()},a.openNewMessage=function(){var e=Object(h.a)(p.a.mark((function e(t){var n,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.state.toggleHide&&a.toggleHideSimple(!0),e.next=3,a.fetchConversations();case 3:if(n=a.state.conversations.map((function(e){return e.id})),console.log(t),console.log(n),r=n.indexOf(t),console.log(r),-1!==r){e.next=10;break}return e.abrupt("return");case 10:a.selectConversation(a.state.conversations[r]);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.toggleCollapse=function(e){var t,n=!a.state[e];a.setState(Object(Y.a)({},e,n)),"contactsCollapsed"===e?t=document.getElementById("contacts-card"):"openMessageCollapsed"===e&&(t=document.getElementById("open-message-card")),n?Object(Cn.a)({targets:[t],height:64,easing:"easeInOutQuad",duration:300}):Object(Cn.a)({targets:[t],height:364,easing:"easeInOutQuad",duration:300})},a.fetchConversations=Object(h.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ht.Message.getConversations();case 3:return t=e.sent,e.next=6,new Promise((function(e){return a.setState({conversations:t},e)}));case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),N(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])}))),a.selectConversation=function(e){var t=a.state.activeConversations;t.map((function(e){return e.id})).includes(e.id)||(2===t.length?(t.splice(0,1),t.push(e)):t.push(e),a.setState({activeConversations:t}),a.props.setActiveConversationIds(t.map((function(e){return e.id}))))},a.removeConversation=function(e){var t=a.state.activeConversations,n=t.findIndex((function(t){return t.id===e}));-1!==n&&(t.splice(n,1),a.setState({activeConversations:t}),a.props.setActiveConversationIds(t.map((function(e){return e.id})))),a.fetchConversations()},a.showNew=function(e){return!a.state.activeConversations.map((function(e){return e.id})).includes(e.id)&&e.newMessages},a.state={isAuthed:!1,collapsed:!0,contactsCollapsed:!1,openMessageCollapsed:!1,toggleHide:!0,conversations:[],activeConversations:[],socket:null,createConversationIsVisible:!1},a}return Object(i.a)(n,[{key:"componentDidMount",value:function(){this.fetchConversations(),this.props.setOpenNewMessage(this.openNewMessage),E("new-message",this.fetchConversations)}},{key:"componentWillUnmount",value:function(){P("new-message",this.fetchConversations)}},{key:"render",value:function(){var e=this,t=this.props.isMobile;return Object(R.jsxs)(v.b,{align:t?"start":"end",size:"large",direction:t?"vertical":"horizontal",style:{position:"fixed",left:t?10:17.5,bottom:20,zIndex:100},children:[!t&&Object(R.jsx)(yn.a,{placement:"right",title:"Messages",children:Object(R.jsx)(y.a,{shape:"circle",size:"large",onClick:this.toggleHideSimple,icon:Object(R.jsx)(wn.a,{})})}),Object(R.jsx)("div",{children:Object(R.jsx)(vn,{toggleCollapse:function(){return e.toggleCollapse("contactsCollapsed")},toggleHide:this.state.toggleHide,isMobile:t,sendMessage:function(){return e.setState({createConversationIsVisible:!0})},conversations:this.state.conversations,selectConversation:function(t,n){e.selectConversation(n),t.preventDefault()},activeConversations:this.state.activeConversations})}),this.state.activeConversations.map((function(t){return Object(R.jsx)(In,{socket:e.state.socket,toggleHide:e.state.toggleHide,fetchConversations:e.fetchConversations,removeConversation:e.removeConversation,conversation:t,fetchUnreadNotifications:e.props.fetchUnreadNotifications},t.id)})),t&&Object(R.jsx)(yn.a,{placement:"right",title:"Messages",children:Object(R.jsx)(y.a,{shape:"circle",size:"large",onClick:this.toggleHideSimple,icon:Object(R.jsx)(wn.a,{})})}),Object(R.jsx)(Mn,{visible:this.state.createConversationIsVisible,fetchConversations:this.fetchConversations,selectConversation:this.selectConversation,closeModal:function(){return e.setState({createConversationIsVisible:!1})}})]})}}]),n}(r.a.Component),An=Object(j.h)(Dn),Un=n(676),En=n(677),Pn=n(678),Bn=n(679),Tn=oe.a.SubMenu,Rn=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={collapsed:!1},e.toggleCollapsed=function(){var t=Object(h.a)(p.a.mark((function t(n,a){var r,s,c,o,i;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=!e.state.collapsed,"boolean"===typeof n&&(r=n),e.setState({collapsed:r}),s=document.getElementById("bugg-nav-logo"),c=document.getElementById("bugg-nav-background"),o=document.getElementById("bugg-nav-collaspe-button"),i=document.getElementById("bugg-dashboard"),t.next=9,Ln({logo:s,collapsed:r,panel:c,button:o,dashboard:i},a);case 9:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e}return Object(i.a)(n,[{key:"componentDidMount",value:function(){void 0!==this.props.initialCollasped?this.toggleCollapsed(this.props.initialCollasped):this.toggleCollapsed(!1)}},{key:"componentWillUnmount",value:function(){var e=Object(h.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.toggleCollapsed(!0,!0);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e,t=this,n=null!==(e=this.props.projects)&&void 0!==e?e:[];return Object(R.jsxs)("div",{id:"bugg-nav-background",className:"navigation",style:Fn.navigation,children:[Object(R.jsxs)(v.b,{style:Fn.Space1,align:"center",direction:"horizontal",children:[Object(R.jsx)(y.a,{id:"bugg-nav-collaspe-button",type:"text",onClick:this.toggleCollapsed,style:Fn.Button1,children:r.a.createElement(this.state.collapsed?Un.a:En.a)}),Object(R.jsx)("h2",{id:"bugg-nav-logo",style:Fn.h2,children:"Bugg"})]}),Object(R.jsxs)(oe.a,{defaultSelectedKeys:["home"],defaultOpenKeys:["sub1"],mode:"inline",theme:"dark",style:Fn.Menu,inlineCollapsed:this.state.collapsed,children:[Object(R.jsx)(oe.a.Item,{onClick:function(){return t.props.history.push("/dashboard")},style:Fn.Item1,icon:Object(R.jsx)(Pn.a,{}),children:"Home"},"home"),Object(R.jsx)(oe.a.Item,{onClick:function(){return t.props.history.push("/dashboard/settings")},style:{backgroundColor:"transparent"},icon:Object(R.jsx)(rn.a,{}),children:"Settings"},"settings"),Object(R.jsx)(Tn,{style:{backgroundColor:"transparent"},icon:Object(R.jsx)(Bn.a,{}),title:"Projects",className:"bugg-sub-menu",children:n.map((function(e,n){return Object(R.jsx)(oe.a.Item,{style:{backgroundColor:"transparent"},onClick:function(){return t.props.history.push("/dashboard/projects/"+e.id)},children:e.title},e.id)}))},"projects")]})]})}}]),n}(r.a.Component),Ln=function(){var e=Object(h.a)(p.a.mark((function e(){var t,n,a=arguments;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.length>0&&void 0!==a[0]?a[0]:{collapsed:"",logo:"",panel:"",button:"",dashboard:""},n=a.length>1?a[1]:void 0,!t.collapsed){e.next=7;break}return e.next=5,Promise.all([Object(Cn.a)({targets:[t.logo],opacity:0,translateX:30,duration:300,easing:"easeInOutQuad"}).finished,Object(Cn.a)({targets:[t.panel],width:75,easing:"easeInOutQuad",duration:300}).finished,Object(Cn.a)({targets:[t.button],translateX:8,duration:100,easing:"easeInOutQuad",scale:1.2}).finished,Object(Cn.a)({targets:[t.dashboard],paddingLeft:n?20:130,duration:300,easing:"easeInOutQuad"}).finished]);case 5:e.next=9;break;case 7:return e.next=9,Promise.all([Object(Cn.a)({targets:[t.logo],color:"rgba(255, 255, 255, 1)",opacity:1,translateX:0,duration:300,easing:"easeInOutQuad"}).finished,Object(Cn.a)({targets:[t.panel],width:270,easing:"easeInOutQuad",duration:300}).finished,Object(Cn.a)({delay:0,targets:[t.button],translateX:0,duration:100,easing:"easeInOutQuad",scale:1}).finished,Object(Cn.a)({targets:[t.dashboard],paddingLeft:330,duration:300,easing:"easeInOutQuad"}).finished]);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Fn={Dashboard:{display:"inline-flex",width:"100%",paddingLeft:330,paddingBottom:64},navigation:{color:"white",width:0,zIndex:10,"box-shadow":"-7px 0px 13px 0px black",boxShadow:1,overflowY:"auto",overflowX:"hidden",position:"fixed",left:0,top:0,height:"100%",backgroundColor:"#0093E9",backgroundImage:"linear-gradient(43deg, #0093E9 0%, #80D0C7 100%)",display:"flex",flexDirection:"column"},Space1:{marginTop:30,paddingLeft:9,marginBottom:30},Button1:{color:"white"},h2:{margin:0,color:"white",top:29,left:70},Menu:{backgroundColor:"transparent"},Item1:{backgroundColor:"transparent"},header:{width:"100%",display:"inline-flex",justifyContent:"space-between",height:110,alignItems:"center"}},zn=Object(j.h)(Rn),_n=n(659),Wn=n(680);var Vn=function(e){return Object(R.jsx)(oe.a,{style:{width:150},children:Object(R.jsx)(oe.a.Item,{onClick:e.logout,style:{color:"red"},children:"Logout"},"0")})},qn={header:{width:"100%",display:"inline-flex",justifyContent:"space-between",height:110,alignItems:"center"}},Hn=function(e){var t=Object(k.useMediaQuery)({maxWidth:800});return Object(R.jsxs)("div",{className:"header",style:qn.header,children:[Object(R.jsx)("h2",{style:Object(Q.a)({},t?{fontSize:18}:{}),children:"Welcome"+(e.name?", ":"")+e.name}),Object(R.jsxs)(v.b,{children:[Object(R.jsx)(_n.a,{offset:[-4,8],count:e.unreadNotifications,children:Object(R.jsx)(y.a,{type:"default",shape:"circle",size:"large",style:{transform:"scale(1.2)",color:"rgba(0,0,0,.7)"},onClick:e.toggleNotificationDrawer,icon:Object(R.jsx)(Wn.a,{style:{}})})}),Object(R.jsx)("style",{children:"\n            .bugg-profile-pic:hover {\n                cursor: pointer;\n            }\n            "}),Object(R.jsx)(ie.a,{overlay:Vn({logout:e.logout}),trigger:["click"],children:Object(R.jsx)(xe.a,{className:"bugg-profile-pic",size:50,src:e.userIconUri,style:Object(Q.a)({marginRight:64,borderWidth:1,borderColor:"rgba(0,0,0,.2)",borderStyle:"solid"},t?{marginRight:10}:{})})})]})]})},Yn=oe.a.SubMenu,Qn=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={collapsed:!0},e.toggleCollapsed=Object(h.a)(p.a.mark((function t(){var n,a,r,s,c,o;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=document.getElementById("bugg-mobile-nav-backdrop"),a=!e.state.collapsed,e.setState({collapsed:a}),r=document.getElementById("bugg-nav-logo-mobile"),s=document.getElementById("bugg-nav-background-mobile"),c=document.getElementById("bugg-nav-collaspe-button-mobile"),o=document.getElementById("bugg-dashboard"),t.prev=7,t.next=10,Xn({logo:r,collapsed:a,panel:s,button:c,dashboard:o,backdrop:n});case 10:t.next=15;break;case 12:t.prev=12,t.t0=t.catch(7),alert(t.t0);case 15:case"end":return t.stop()}}),t,null,[[7,12]])}))),e.navigateTo=function(t){e.props.history.push(t),e.toggleCollapsed()},e}return Object(i.a)(n,[{key:"render",value:function(){var e,t=this,n=null!==(e=this.props.projects)&&void 0!==e?e:[];return Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)("div",{style:{height:64,borderColor:"rgba(0,0,0,.1)",borderWidth:0,borderBottomWidth:1,borderStyle:"solid",marginLeft:-20,marginRight:-10},children:Object(R.jsxs)("div",{style:{height:64,display:"flex",flexDirection:"row",alignItems:"center",paddingLeft:20,gap:15,zIndex:100,position:"fixed",top:0,left:0,width:"100%",boxShadow:"black 0px -4px 13px 0px",backgroundImage:"linear-gradient( 43deg, rgb(0, 147, 233) 0%, rgb(128, 208, 199) 100%)",backgroundColor:"rgb(0, 147, 233)"},children:[Object(R.jsx)(y.a,{type:"ghost",onClick:this.toggleCollapsed,style:Gn.Button1,children:this.state.collapsed?Object(R.jsx)(Un.a,{style:{color:"white"}}):Object(R.jsx)(En.a,{style:{color:"white"}})}),Object(R.jsx)("h3",{style:{margin:0,color:"white"},children:"Bugg"})]})}),Object(R.jsxs)("div",{id:"bugg-nav-background-mobile",style:Object(Q.a)(Object(Q.a)({},Gn.navigation),{},{transform:"translateX(-270px)"}),children:[Object(R.jsxs)(v.b,{style:Gn.Space1,align:"center",direction:"horizontal",children:[Object(R.jsx)(y.a,{id:"bugg-nav-collaspe-button-mobile",type:"text",onClick:this.toggleCollapsed,style:Gn.Button1,children:r.a.createElement(this.state.collapsed?Un.a:En.a)}),Object(R.jsx)("h2",{id:"bugg-nav-logo-mobile",style:Gn.h2,children:"Bugg"})]}),Object(R.jsxs)(oe.a,{defaultSelectedKeys:["home"],defaultOpenKeys:["projects"],mode:"inline",theme:"dark",style:Gn.Menu,inlineCollapsed:this.state.collapsed,children:[Object(R.jsx)(oe.a.Item,{onClick:function(){return t.navigateTo("/dashboard")},style:Gn.Item1,icon:Object(R.jsx)(Pn.a,{}),children:"Home"},"home"),Object(R.jsx)(oe.a.Item,{onClick:function(){return t.navigateTo("/dashboard/settings")},style:{backgroundColor:"transparent"},icon:Object(R.jsx)(rn.a,{}),children:"Settings"},"settings"),Object(R.jsx)(Yn,{style:{backgroundColor:"transparent"},icon:Object(R.jsx)(Bn.a,{}),title:"Projects",className:"bugg-sub-menu",children:n.map((function(e,n){return Object(R.jsx)(oe.a.Item,{style:{backgroundColor:"transparent"},onClick:function(){return t.navigateTo("/dashboard/projects/"+e.id)},children:e.title},e.id)}))},"projects")]})]}),Object(R.jsx)("div",{onClick:function(){!1===t.state.collapsed&&t.toggleCollapsed()},id:"bugg-mobile-nav-backdrop",style:{display:"none",opacity:0,position:"fixed",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(0 0 0 / 50%)",zIndex:1e7},children:"dsadsa"})]})}}]),n}(r.a.Component),Xn=function(){var e=Object(h.a)(p.a.mark((function e(){var t,n=arguments;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.length>0&&void 0!==n[0]?n[0]:{collapsed:"",logo:"",panel:"",button:"",dashboard:"",backdrop:""},n.length>1?n[1]:void 0,!t.collapsed){e.next=8;break}return e.next=5,Promise.all([Object(Cn.a)({targets:[t.logo],opacity:0,translateX:30,duration:300,easing:"easeInOutQuad"}).finished,Object(Cn.a)({targets:[t.panel],translateX:-270,easing:"easeInOutQuad",duration:300}).finished,Object(Cn.a)({targets:[t.button],translateX:8,duration:100,easing:"easeInOutQuad",scale:1.2}).finished,Object(Cn.a)({targets:[t.backdrop],opacity:0,duration:300,easing:"easeInOutQuad"}).finished]);case 5:t.backdrop.style.display="none",e.next=11;break;case 8:return t.backdrop.style.display="block",e.next=11,Promise.all([Object(Cn.a)({targets:[t.logo],color:"rgba(255, 255, 255, 1)",opacity:1,translateX:0,duration:300,easing:"easeInOutQuad"}).finished,Object(Cn.a)({targets:[t.panel],translateX:0,easing:"easeInOutQuad",duration:300}).finished,Object(Cn.a)({delay:0,targets:[t.button],translateX:0,duration:100,easing:"easeInOutQuad",scale:1}).finished,Object(Cn.a)({targets:[t.backdrop],opacity:1,duration:300,easing:"easeInOutQuad"}).finished]);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Gn={Dashboard:{display:"inline-flex",width:"100%",paddingLeft:330,paddingBottom:64},navigation:{color:"white",width:270,zIndex:1e8,"box-shadow":"-7px 0px 13px 0px black",boxShadow:1,overflowY:"auto",overflowX:"hidden",position:"fixed",left:0,top:0,height:"100%",backgroundColor:"#0093E9",backgroundImage:"linear-gradient(43deg, #0093E9 0%, #80D0C7 100%)",display:"flex",flexDirection:"column"},Space1:{marginTop:30,paddingLeft:9,marginBottom:30},Button1:{color:"white"},h2:{margin:0,color:"white",top:29,left:70},Menu:{backgroundColor:"transparent"},Item1:{backgroundColor:"transparent"},header:{width:"100%",display:"inline-flex",justifyContent:"space-between",height:110,alignItems:"center"}},Jn=Object(j.h)(Qn),Kn=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).setActiveConversationIds=function(e){return a.setState({activeConversationIds:e})},a.fetchUnreadNotifications=Object(h.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ht.Notification.getUnreadNotifications();case 3:t=e.sent,a.setState({unreadNotifications:t}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),N(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),a.handleErrorTest=Object(h.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C.a.get("/throw-error");case 3:e.next=9;break;case 5:e.prev=5,e.t0=e.catch(0),t=I(e.t0),console.log(t);case 9:case"end":return e.stop()}}),e,null,[[0,5]])}))),a.openNewMessage=function(){},a.setOpenNewMessage=function(e){a.openNewMessage=function(t){e(t),a.setState({toggleDrawer:!1})}},a.logout=function(){var e=window.localStorage.getItem("token");T(e),window.localStorage.removeItem("token"),a.props.history.push("/auth")},a.updateProjects=Object(h.a)(p.a.mark((function e(){var t,n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C.a.get("/project/all",{headers:D()});case 3:t=e.sent,n=t.data,a.setState({projects:n.projects}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(I(e.t0));case 11:case"end":return e.stop()}}),e,null,[[0,8]])}))),a.getAction=function(e){switch(e.type){case"PROJECT_INVITE":a.joinProject(e.payload.projectId);break;case"NEW_MESSAGE":a.openNewMessage(e.payload.conversationId);break;case"NEW_BUG":a.props.history.push("/dashboard/projects/"+e.payload.projectId+"?action=OPEN_BUG&bugId=".concat(e.payload.bugId)),a.setState({toggleDrawer:!1});break;case"NEW_ANNOUNCEMENT":a.props.history.push("/dashboard/projects/"+e.payload.projectId+"?action=OPEN_ANNOUNCEMENT&announcementId=".concat(e.payload.announcementId)),a.setState({toggleDrawer:!1});break;default:se.b.error("no type given")}},a.getNotificationCallToAction=function(e){var t;return null!==(t={PROJECT_INVITE:" Click this notification to join.",NEW_MESSAGE:" Click this notification to view."}[e])&&void 0!==t?t:" Click this notification to view."},a.onRecieveNotitification=function(e){a.fetchUnreadNotifications(),"NEW_MESSAGE"===e.type&&a.state.activeConversationIds.includes(e.payload.conversationId)||x.a.open({message:e.title,description:e.description+a.getNotificationCallToAction(e.type),onClick:function(){a.getAction(e),a.dismissNotification(e.id)}})},a.dismissNotification=function(){var e=Object(h.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C.a.delete(M+"/notification/"+t,{headers:D()});case 3:a.fetchUnreadNotifications(),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),N(e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),a.getWelcomeMessage=Object(h.a)(p.a.mark((function e(){var t,n,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=function(e){var t=e.split(" "),n=t[0];return t[1]&&(n+=" "+t[1].substring(0,1).toUpperCase()+"."),n},e.prev=1,e.next=4,ht.User.getMe();case 4:return n=e.sent,e.next=7,ht.User.getUserIconUri();case 7:r=e.sent,a.setState({name:t(n.name),userIconUri:r}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),console.error(I(e.t0));case 14:case"end":return e.stop()}}),e,null,[[1,11]])}))),a.joinProject=function(){var e=Object(h.a)(p.a.mark((function e(t){var n,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C.a.post("/project/join",{projectId:t},{headers:D()});case 3:n=e.sent,r=n.data,x.a.success({message:"You have joined project "+r.project.title+"!"}),a.updateProjects(),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),N(e.t0),x.a.error({message:I(e.t0)});case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),a.state={isAuthed:!1,collapsed:!1,toggleDrawer:!1,projects:[],socket:null,name:"",userIconUri:"",unreadNotifications:0,activeConversationIds:[],initialStyles:{}},a}return Object(i.a)(n,[{key:"componentDidMount",value:function(){this.updateProjects(),this.getWelcomeMessage(),B(),this.fetchUnreadNotifications(),E("new-notification",this.onRecieveNotitification)}},{key:"componentDidUpdate",value:function(e){this.props.location!==e.location&&this.updateProjects()}},{key:"componentWillUnmount",value:function(){P("new-notification",this.onRecieveNotitification)}},{key:"render",value:function(){var e=this;return Object(R.jsx)(S.a,{maxWidth:800,children:function(t){return Object(R.jsxs)("div",{id:"bugg-dashboard",className:"Dashboard",style:{width:"100%",paddingLeft:20,paddingRight:10,paddingBottom:64},children:[!t&&Object(R.jsx)(zn,{projects:e.state.projects}),t&&Object(R.jsx)(Jn,{projects:e.state.projects}),Object(R.jsxs)("div",{className:"main-wrapper",style:{flex:1},children:[Object(R.jsx)(Hn,{name:e.state.name,unreadNotifications:e.state.unreadNotifications,logout:e.logout,userIconUri:e.state.userIconUri,toggleNotificationDrawer:function(){return e.setState({toggleDrawer:!0})}}),Object(R.jsx)(j.b,{exact:!0,path:"/dashboard",children:Object(R.jsx)(bn,{projects:e.state.projects,updateProjects:e.updateProjects})}),Object(R.jsx)(j.b,{path:"/dashboard/settings",children:Object(R.jsx)(gn,{getWelcomeMessage:e.getWelcomeMessage})}),Object(R.jsx)(j.b,{path:"/dashboard/projects/:projectId",children:Object(R.jsx)(on,{updateProjects:e.updateProjects})})]}),Object(R.jsx)(ue.a,{width:t?"90%":500,title:"Notifications",placement:"right",closable:!0,onClose:function(){e.fetchUnreadNotifications(),e.setState({toggleDrawer:!1})},destroyOnClose:!0,visible:e.state.toggleDrawer,children:Object(R.jsx)(xn,{close:function(){e.fetchUnreadNotifications(),e.setState({toggleDrawer:!1})},openNewMessage:e.openNewMessage,joinProject:e.joinProject,socket:e.state.socket})}),Object(R.jsx)(An,{isMobile:t,setActiveConversationIds:e.setActiveConversationIds,setOpenNewMessage:e.setOpenNewMessage,fetchUnreadNotifications:e.fetchUnreadNotifications})]})}})}}]),n}(r.a.Component),Zn=Object(j.h)(Kn),$n=(n(639),function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={isAuthed:!1},a}return Object(i.a)(n,[{key:"componentDidMount",value:function(){window.localStorage.getItem("token")&&this.setState({isAuthed:!0})}},{key:"render",value:function(){var e=null!==window.localStorage.getItem("token");return C.a.defaults.baseURL=M,Object(R.jsxs)(z.a,{children:[e?null:Object(R.jsx)(j.a,{to:"/auth"}),-1!==window.location.pathname.indexOf("dashboard")&&e||!e?null:Object(R.jsx)(j.a,{to:"dashboard"}),Object(R.jsxs)(j.d,{children:[Object(R.jsx)(j.b,{path:"/auth",children:Object(R.jsx)(F,{})}),Object(R.jsx)(j.b,{path:"/dashboard",children:Object(R.jsx)(Zn,{})})]})]})}}]),n}(r.a.Component)),ea=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,681)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,s=t.getLCP,c=t.getTTFB;n(e),a(e),r(e),s(e),c(e)}))};c.a.render(Object(R.jsx)(r.a.StrictMode,{children:Object(R.jsx)($n,{})}),document.getElementById("root")),ea()}},[[640,1,2]]]);
//# sourceMappingURL=main.a355cc70.chunk.js.map